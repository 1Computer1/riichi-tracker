var fa=Object.defineProperty;var pa=(e,r,i)=>r in e?fa(e,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[r]=i;var pe=(e,r,i)=>(pa(e,typeof r!="symbol"?r+"":r,i),i);import{D as ba,d as $e,j as a,c as D,a as t,F as _,r as w,b as xa,m as Pe,f as Qe,u as Ve,e as se,i as we,g as ka,v as va,C as ya,h as wa,R as Na,H as Ca,k as Da,l as be}from"./vendor.cc215caa.js";import{S as Ea,a as Sa,b as Ya,c as Ba,d as Fa,e as Aa,f as Wa,g as ja,h as Ta,i as za,j as Ra,k as Ma,l as Ha,m as $a,n as Pa,o as La,p as Ia,q as Oa,r as Ga,s as Ka,t as qa,u as Ua,v as _a,w as Qa,x as Va,y as Xa,z as Za,A as Ja,B as er,C as ar,D as rr,E as nr,F as ir,G as lr,H as tr,I as sr,J as or}from"./tiles-light.ddd8b723.js";import{S as ur,a as dr,b as cr,c as mr,d as hr,e as gr,f as fr,g as pr,h as br,i as xr,j as kr,k as vr,l as yr,m as wr,n as Nr,o as Cr,p as Dr,q as Er,r as Sr,s as Yr,t as Br,u as Fr,v as Ar,w as Wr,x as jr,y as Tr,z as zr,A as Rr,B as Mr,C as Hr,D as $r,E as Pr,F as Lr,G as Ir,H as Or,I as Gr,J as Kr}from"./tiles-dark.985f36ef.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerpolicy&&(s.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?s.credentials="include":l.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(l){if(l.ep)return;l.ep=!0;const s=i(l);fetch(l.href,s)}})();const Ee={noYakuFu:!1,noYakuDora:!1,openTanyao:!0,ryuuiisouHatsu:!1,multiYakuman:!0,doubleYakuman:!0,kiriageMangan:!1,kazoeYakuman:!0,doubleWindFu:!0,rinshanFu:!0,sanma:null,akadora:!0,usePao:!1,otherScoring:!1,disabledYaku:[],enabledLocalYaku:[]};function ue(e){return{ok:!0,value:e}}function de(){return{ok:!1,value:null}}function Le(e){return{roundWind:e.roundWind,round:e.round,repeats:e.repeats,bottomWind:e.bottomWind,scores:e.scores,riichiSticks:e.riichiSticks,riichi:e.riichi,settings:e.settings}}function qr(e,r){return{id:e,roundWind:r.roundWind,round:r.round,repeats:r.repeats,bottomWind:r.bottomWind,scores:r.scores,riichiSticks:r.riichiSticks,riichi:r.riichi,settings:r.settings}}function Ie(e){return{noYakuFu:e.noYakuFu,noYakuDora:e.noYakuDora,openTanyao:e.openTanyao,ryuuiisouHatsu:e.ryuuiisouHatsu,multiYakuman:e.multiYakuman,doubleYakuman:e.doubleYakuman,kiriageMangan:e.kiriageMangan,kazoeYakuman:e.kazoeYakuman,doubleWindFu:e.doubleWindFu,rinshanFu:e.rinshanFu,sanma:e.sanma,akadora:e.akadora,usePao:e.usePao,otherScoring:e.otherScoring,disabledYaku:e.disabledYaku,enabledLocalYaku:e.enabledLocalYaku}}function Ur(e,r){return{id:e,noYakuFu:r.noYakuFu,noYakuDora:r.noYakuDora,openTanyao:r.openTanyao,ryuuiisouHatsu:r.ryuuiisouHatsu,multiYakuman:r.multiYakuman,doubleYakuman:r.doubleYakuman,kiriageMangan:r.kiriageMangan,kazoeYakuman:r.kazoeYakuman,doubleWindFu:r.doubleWindFu,rinshanFu:r.rinshanFu,sanma:r.sanma,akadora:r.akadora,usePao:r.usePao,otherScoring:r.otherScoring,disabledYaku:r.disabledYaku,enabledLocalYaku:r.enabledLocalYaku}}class _r extends ba{constructor(){super(...arguments);pe(this,"games");pe(this,"settings")}}const q=new _r("riichi-tracker");q.version(1).stores({games:"++id"});q.version(2).stores({games:"++id"}).upgrade(e=>e.table("games").toCollection().modify(r=>{r.riichiSticks=0,r.riichi=[!1,!1,!1,!1],r.repeats=0}));function Xe(e){var r;e.settings={...Ee,...(r=e.settings)!=null?r:{}}}q.version(3).stores({games:"++id"}).upgrade(e=>e.table("games").toCollection().modify(r=>{Xe(r)}));q.version(4).stores({games:"++id",settings:"++id"}).upgrade(e=>e.table("games").toCollection().modify(r=>{Xe(r)}));const Qr={async getGame(e){const r=await q.games.where("id").equals(e).toArray();if(!r.length)return de();const[i]=r;return ue(Le(i))},useGame(e,r={enabled:!0}){const i=$e.exports.useLiveQuery(()=>r.enabled?q.games.where("id").equals(e).toArray():null,[e]);if(i==null)return null;if(!i.length)return de();const[n]=i;return ue(Le(n))},async setGame(e,r){await q.games.put(qr(e,r))},async getSettings(e){const r=await q.settings.where("id").equals(e).toArray();if(!r.length)return de();const[i]=r;return ue(Ie(i))},async setSettings(e,r){await q.settings.put(Ur(e,r))},useSettings(e,r={enabled:!0}){const i=$e.exports.useLiveQuery(()=>r.enabled?q.settings.where("id").equals(e).toArray():null);if(i==null)return null;if(!i.length)return de();const[n]=i;return ue(Ie(n))}},Vr=()=>Qr;function te(e,r){return Array.from({length:r},()=>e)}function Ze(){localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}function v({active:e=!1,disabled:r=!1,onClick:i,children:n}){return a("button",{className:D("border border-gray-800 rounded-xl shadow p-1 lg:p-2 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600","w-52 lg:w-80 h-10 lg:h-14 text-xl lg:text-2xl",e?"bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800":"bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600"),onClick:l=>{l.preventDefault(),i==null||i()},disabled:r,children:n})}function ae({onClick:e,highlight:r=!1,children:i}){return a("button",{className:D("border border-gray-800 rounded-full p-1 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600",r?"bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800":"bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600"),onClick:n=>{n.preventDefault(),e==null||e()},children:a("div",{className:"w-6 h-6 lg:w-12 lg:h-12 text-xl lg:text-3xl flex flex-col justify-center items-center",children:i})})}function Je(){return a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 12H4"})})}function ea(){return a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})}function J({onIncrement:e,onDecrement:r,canIncrement:i=!0,canDecrement:n=!0,children:l}){return t("div",{className:D("flex flex-row justify-center items-stretch w-52 lg:w-80 h-10 lg:h-14 text-xl lg:text-2xl"),children:[a("button",{onClick:r,disabled:!n,className:"flex justify-center items-center rounded-xl w-[15%] border rounded-r-none border-r-0 shadow bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600 border-gray-800 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600",children:a("div",{className:"w-4 h-4 lg:w-6 lg:h-6",children:a(Je,{})})}),a("div",{className:"flex justify-center items-center p-1 lg:p-2 w-[70%] border bg-gray-50 dark:bg-gray-500 border-gray-800",children:l}),a("button",{onClick:e,disabled:!i,className:"flex justify-center items-center border border-l-0 rounded-l-none w-[15%] rounded-xl shadow bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600 border-gray-800 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600",children:a("div",{className:"w-4 h-4 lg:w-6 lg:h-6",children:a(ea,{})})})]})}function xe({element:e,alignToTop:r=!0,highlight:i,onJump:n,children:l}){return a(ae,{highlight:i,onClick:()=>{e==null||e.scrollIntoView(r),n==null||n()},children:l})}function Se({toggled:e,left:r,right:i,forced:n=!1,onToggle:l}){return a("div",{className:"flex flex-row w-52 lg:w-80 h-10 lg:h-14 text-xl lg:text-2xl",children:n?a("button",{disabled:!0,className:D("flex justify-center items-center rounded-xl border w-full shadow p-1 lg:p-2 border-gray-800","bg-amber-500 dark:bg-amber-700"),children:e?i:r}):t(_,{children:[a("button",{className:D("flex justify-center items-center rounded-xl w-1/2 border rounded-r-none shadow p-1 lg:p-2 border-gray-800 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600",e?"bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600":"bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800"),onClick:l?s=>{s.preventDefault(),e&&l(!1)}:void 0,children:r}),a("button",{className:D("flex justify-center items-center border rounded-l-none w-1/2 rounded-xl shadow p-1 lg:p-2 border-gray-800 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600",e?"bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800":"bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600"),onClick:l?s=>{s.preventDefault(),e||l(!0)}:void 0,children:i})]})})}function H({toggled:e,incompatible:r=!1,disabled:i=!1,forced:n=!1,children:l,onToggle:s}){return a("div",{className:"flex flex-row w-52 lg:w-80 h-10 lg:h-14 text-xl lg:text-2xl",children:n?a("button",{disabled:!0,className:D("flex justify-center items-center rounded-xl border w-full shadow p-1 lg:p-2 border-gray-800",e?"bg-amber-500 dark:bg-amber-700":"bg-gray-300 dark:bg-gray-800 dark:text-gray-600"),children:l}):a("button",{className:D("flex justify-center items-center rounded-xl w-full border shadow p-1 lg:p-2 border-gray-800 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600",!e&&r?"bg-gray-200 hover:bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-600":e?"bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800":"bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600"),disabled:i,onClick:s&&(c=>{c.preventDefault(),s(!e)}),children:l})})}function O({children:e}){return a("div",{className:"w-full overflow-x-auto",children:a("div",{className:"flex flex-row justify-center items-center gap-x-2 gap-y-2 min-w-min px-2",children:e})})}function Xr({han:e,fu:r,onHanChange:i,onFuChange:n}){return t(O,{children:[t("div",{className:"flex flex-row justify-center items-center gap-x-2",children:[a("p",{className:"text-2xl",children:"Han"}),a("input",{type:"text",inputMode:"numeric",className:"bg-slate-300 dark:bg-sky-900 text-amber-700 dark:text-amber-500 font-bold text-center text-2xl lg:text-4xl rounded-xl w-20 lg:w-32 p-1",value:e,onChange:l=>{var c,x;const s=Number((x=(c=l.target.value.match(/^\d+/))==null?void 0:c[0])!=null?x:0);isNaN(s)||i==null||i(s)}})]}),t("div",{className:"flex flex-row justify-center items-center gap-x-2",children:[a("p",{className:"text-2xl",children:"Fu"}),a("input",{type:"text",inputMode:"numeric",className:"bg-slate-300 dark:bg-sky-900 text-amber-700 dark:text-amber-500 font-bold text-center text-2xl lg:text-4xl rounded-xl w-20 lg:w-32 p-1",value:r,onChange:l=>{var c,x;const s=Number((x=(c=l.target.value.match(/^\d+/))==null?void 0:c[0])!=null?x:0);isNaN(s)||n==null||n(s)}})]})]})}function aa(e){const[r,i]=w.exports.useState(localStorage.getItem(e)),n=w.exports.useCallback(l=>{l==null?localStorage.removeItem(e):localStorage.setItem(e,l),i(l)},[e]);return[r,n]}function Zr(){const[e]=aa("theme"),r=window.matchMedia("(prefers-color-scheme: dark)"),[i,n]=w.exports.useState(r.matches);return r.addEventListener("change",l=>n(l.matches)),e!=null?e:i?"dark":"light"}function Oe(e){return{"1m":[Ea,ur],"2m":[Sa,dr],"3m":[Ya,cr],"4m":[Ba,mr],"5m":[Fa,hr],"6m":[Aa,gr],"7m":[Wa,fr],"8m":[ja,pr],"9m":[Ta,br],"0m":[za,xr],"1p":[Ra,kr],"2p":[Ma,vr],"3p":[Ha,yr],"4p":[$a,wr],"5p":[Pa,Nr],"6p":[La,Cr],"7p":[Ia,Dr],"8p":[Oa,Er],"9p":[Ga,Sr],"0p":[Ka,Yr],"1s":[qa,Br],"2s":[Ua,Fr],"3s":[_a,Ar],"4s":[Qa,Wr],"5s":[Va,jr],"6s":[Xa,Tr],"7s":[Za,zr],"8s":[Ja,Rr],"9s":[er,Mr],"0s":[ar,Hr],"1z":[rr,$r],"2z":[nr,Pr],"3z":[ir,Lr],"4z":[lr,Ir],"5z":[tr,Or],"6z":[sr,Gr],"7z":[or,Kr]}[e]}function Ge({tile:e}){const r=Zr();if(e==="00"){const n=Oe("5z")[r==="dark"?1:0];return a(n,{className:D("h-16 w-12 min-w-[3rem] lg:h-20 lg:w-[60px] lg:min-w-[60px] p-2 rounded-xl"),viewBox:"0 0 300 400"})}const i=Oe(e)[r==="dark"?1:0];return a(i,{className:D("h-16 w-12 min-w-[3rem] lg:h-20 lg:w-[60px] lg:min-w-[60px] p-2 rounded-xl"),viewBox:"0 0 300 400"})}function ra(){return a("div",{className:"h-16 w-12 min-w-[3rem] lg:h-20 lg:w-[60px] lg:min-w-[60px] p-2 rounded-xl border-2 border-black dark:border-white border-dashed"})}function W({tile:e,agari:r=!1,dora:i=!1,red:n=!1,disabled:l=!1,forced:s=!1,onClick:c}){return s?a("div",{className:D("rounded-xl shadow shadow-gray-400 dark:shadow-gray-800",r?"animate-pulse":"",n?"bg-rose-500 dark:bg-red-700":i?"bg-amber-100 dark:bg-emerald-800":e==="00"?"bg-amber-400 dark:bg-gray-600":"bg-gray-50 dark:bg-gray-500"),children:a(Ge,{tile:e})}):a("button",{onClick:c&&(x=>{x.preventDefault(),c(e)}),disabled:l,className:D("disabled:opacity-50 rounded-xl shadow shadow-gray-400 dark:shadow-gray-800",r?"animate-pulse":"",n?"bg-rose-500 enabled:hover:bg-rose-600 enabled:group-hover:bg-rose-600 dark:bg-red-700 dark:enabled:hover:bg-red-800 dark:enabled:group-hover:bg-red-800":i?"bg-amber-100 enabled:hover:bg-amber-200 enabled:group-hover:bg-amber-200 dark:bg-emerald-800 dark:enabled:hover:bg-emerald-900 dark:enabled:group-hover:bg-emerald-900":e==="00"?"bg-amber-400 enabled:hover:bg-amber-500 enabled:group-hover:bg-amber-500 dark:bg-gray-600 dark:enabled:hover:bg-gray-700 dark:enabled:group-hover:bg-gray-700":"bg-gray-50 enabled:hover:bg-gray-200 enabled:group-hover:bg-gray-200 dark:bg-gray-500 dark:enabled:hover:bg-gray-600 dark:enabled:group-hover:bg-gray-600"),children:a(Ge,{tile:e})})}function X({tiles:e,melds:r=[]}){return a(O,{children:t("div",{className:"flex flex-row gap-2 justify-center items-center min-w-min",children:[a("div",{className:"flex flex-row justify-center items-center gap-x-0.5",children:e.map((i,n)=>a(W,{tile:i,forced:!0},n))}),r.map((i,n)=>a(Jr,{meld:i},n))]})})}function Jr({meld:e}){return a("div",{className:"flex flex-row gap-x-0.5 group",children:e.t==="chiipon"?e.tiles.map((r,i)=>a(W,{tile:r,forced:!0},i)):e.closed?e.tiles.map((r,i)=>a(W,{tile:i===1||i===2?"00":r,forced:!0},i)):e.tiles.map((r,i)=>a(W,{tile:r,forced:!0},i))})}function g({id:e,name:r,type:i="normal",help:n=null}){return{id:e,name:r,type:i,help:n}}const Ye={\u56FD\u58EB\u7121\u53CC\u5341\u4E09\u9762\u5F85\u3061:g({id:"\u56FD\u58EB\u7121\u53CC\u5341\u4E09\u9762\u5F85\u3061",name:"Thirteen-Wait Thirteen Orphans"}),\u7D14\u6B63\u4E5D\u84EE\u5B9D\u71C8:g({id:"\u7D14\u6B63\u4E5D\u84EE\u5B9D\u71C8",name:"True Nine Gates"}),\u56DB\u6697\u523B\u5358\u9A0E\u5F85\u3061:g({id:"\u56DB\u6697\u523B\u5358\u9A0E\u5F85\u3061",name:"Single-Wait Four Concealed Triplets"}),\u5927\u56DB\u559C:g({id:"\u5927\u56DB\u559C",name:"Four Big Winds"}),\u5929\u548C:g({id:"\u5929\u548C",name:"Blessing of Heaven"}),\u5730\u548C:g({id:"\u5730\u548C",name:"Blessing of Earth"}),\u4EBA\u548C:g({id:"\u4EBA\u548C",name:"Blessing of Man",type:"local",help:a("div",{className:"flex flex-col gap-2",children:a("span",{children:"Yakuman. Call Ron before your first turn. Calls invalidate."})})}),\u56FD\u58EB\u7121\u53CC:g({id:"\u56FD\u58EB\u7121\u53CC",name:"Thirteen Orphans"}),\u4E5D\u84EE\u5B9D\u71C8:g({id:"\u4E5D\u84EE\u5B9D\u71C8",name:"Nine Gates"}),\u56DB\u6697\u523B:g({id:"\u56DB\u6697\u523B",name:"Four Concealed Triplets"}),\u5C0F\u56DB\u559C:g({id:"\u5C0F\u56DB\u559C",name:"Four Little Winds"}),\u5927\u4E09\u5143:g({id:"\u5927\u4E09\u5143",name:"Three Big Dragons"}),\u5B57\u4E00\u8272:g({id:"\u5B57\u4E00\u8272",name:"All Honors"}),\u7DD1\u4E00\u8272:g({id:"\u7DD1\u4E00\u8272",name:"All Green"}),\u6E05\u8001\u982D:g({id:"\u6E05\u8001\u982D",name:"All Terminals"}),\u56DB\u69D3\u5B50:g({id:"\u56DB\u69D3\u5B50",name:"Four Quads"}),\u5927\u4E03\u661F:g({id:"\u5927\u4E03\u661F",name:"Big Seven Stars",type:"local",help:t("div",{className:"flex flex-col gap-2",children:[a("span",{children:"Yakuman. A seven pairs hand containing all seven types of honor tiles. Closed only."}),a(X,{tiles:["1z","1z","2z","2z","3z","3z","4z","4z","5z","5z","6z","6z","7z","7z"]})]})}),\u7D05\u5B54\u96C0:g({id:"\u7D05\u5B54\u96C0",name:"Red Peacock",type:"local",help:t("div",{className:"flex flex-col gap-2",children:[a("span",{children:"Yakuman. A hand built using only red bamboo tiles (1, 5, 7, 9) and Red Dragon."}),a(X,{tiles:["5s","5s","7s","7s","7s","9s","9s","9s","7z","7z","7z"],melds:[{t:"chiipon",tiles:["1s","1s","1s"]}]})]})}),\u9ED2\u4E00\u8272:g({id:"\u9ED2\u4E00\u8272",name:"All Black",type:"local",help:t("div",{className:"flex flex-col gap-2",children:[a("span",{children:"Yakuman. A hand built using only black circles tiles (2, 4, 8) and wind tiles."}),a(X,{tiles:["4p","4p","8p","8p","8p","1z","1z","1z","2z","2z","2z"],melds:[{t:"chiipon",tiles:["2p","2p","2p"]}]})]})}),\u767E\u4E07\u77F3:g({id:"\u767E\u4E07\u77F3",name:"One Million Koku",type:"local",help:t("div",{className:"flex flex-col gap-2",children:[a("span",{children:"Yakuman. A full flush hand of characters, such that the numeric values add up to at least 100."}),a(X,{tiles:["1m","2m","3m","6m","6m","6m","7m","7m"],melds:[{t:"kan",closed:!0,tiles:["8m","8m","8m","8m"]},{t:"kan",closed:!1,tiles:["9m","9m","9m","9m"]}]})]})}),\u7ACB\u76F4:g({id:"\u7ACB\u76F4",name:"Riichi"}),\u30C0\u30D6\u30EB\u7ACB\u76F4:g({id:"\u30C0\u30D6\u30EB\u7ACB\u76F4",name:"Double Riichi",type:"optional"}),\u4E00\u767A:g({id:"\u4E00\u767A",name:"Ippatsu",type:"optional"}),\u9580\u524D\u6E05\u81EA\u6478\u548C:g({id:"\u9580\u524D\u6E05\u81EA\u6478\u548C",name:"Fully Concealed Hand"}),\u5DBA\u4E0A\u958B\u82B1:g({id:"\u5DBA\u4E0A\u958B\u82B1",name:"After a Kan",type:"optional"}),\u6436\u69D3:g({id:"\u6436\u69D3",name:"Robbing a Kan",type:"optional"}),\u6D77\u5E95\u6478\u6708:g({id:"\u6D77\u5E95\u6478\u6708",name:"Under the Sea",type:"optional"}),\u6CB3\u5E95\u6488\u9B5A:g({id:"\u6CB3\u5E95\u6488\u9B5A",name:"Under the River",type:"optional"}),\u5834\u98A8\u6771:g({id:"\u5834\u98A8\u6771",name:"Prevalent Wind (East)"}),\u5834\u98A8\u5357:g({id:"\u5834\u98A8\u5357",name:"Prevalent Wind (South)"}),\u5834\u98A8\u897F:g({id:"\u5834\u98A8\u897F",name:"Prevalent Wind (West)"}),\u5834\u98A8\u5317:g({id:"\u5834\u98A8\u5317",name:"Prevalent Wind (North)"}),\u81EA\u98A8\u6771:g({id:"\u81EA\u98A8\u6771",name:"Seat Wind (East)"}),\u81EA\u98A8\u5357:g({id:"\u81EA\u98A8\u5357",name:"Seat Wind (South)"}),\u81EA\u98A8\u897F:g({id:"\u81EA\u98A8\u897F",name:"Seat Wind (West)"}),\u81EA\u98A8\u5317:g({id:"\u81EA\u98A8\u5317",name:"Seat Wind (North)"}),\u5F79\u724C\u767D:g({id:"\u5F79\u724C\u767D",name:"White Dragon"}),\u5F79\u724C\u767A:g({id:"\u5F79\u724C\u767A",name:"Green Dragon"}),\u5F79\u724C\u4E2D:g({id:"\u5F79\u724C\u4E2D",name:"Red Dragon"}),\u5E73\u548C:g({id:"\u5E73\u548C",name:"Pinfu",type:"optional"}),\u65AD\u4E48\u4E5D:g({id:"\u65AD\u4E48\u4E5D",name:"All Simples",type:"optional"}),\u4E00\u76C3\u53E3:g({id:"\u4E00\u76C3\u53E3",name:"Pure Double Sequence"}),\u5341\u4E8C\u843D\u62AC:g({id:"\u5341\u4E8C\u843D\u62AC",name:"All Calls",type:"local",help:t("div",{className:"flex flex-col gap-2",children:[a("span",{children:"1 Han. A hand with 4 melded sets (not including closed kan) waiting for a single tile to complete. Can win on tsumo or ron."}),a(X,{tiles:["5z","5z"],melds:[{t:"chiipon",tiles:["1m","2m","3m"]},{t:"chiipon",tiles:["2p","3p","4p"]},{t:"kan",closed:!1,tiles:["8p","8p","8p","8p"]},{t:"chiipon",tiles:["7s","8s","9s"]}]})]})}),\u4E09\u8272\u540C\u9806:g({id:"\u4E09\u8272\u540C\u9806",name:"Mixed Triple Sequence"}),\u4E00\u6C17\u901A\u8CAB:g({id:"\u4E00\u6C17\u901A\u8CAB",name:"Pure Straight"}),\u6DF7\u5168\u5E2F\u4E48\u4E5D:g({id:"\u6DF7\u5168\u5E2F\u4E48\u4E5D",name:"Half Outside Hand"}),\u4E03\u5BFE\u5B50:g({id:"\u4E03\u5BFE\u5B50",name:"Seven Pairs"}),\u4E94\u9580\u6589:g({id:"\u4E94\u9580\u6589",name:"All Types",type:"local",help:t("div",{className:"flex flex-col gap-2",children:[a("span",{children:"2 Han. A hand containing all 5 different suits (characters, circles, bamboo, winds, and dragons)."}),a(X,{tiles:["2m","2m","2m","5z","5z"],melds:[{t:"chiipon",tiles:["2p","3p","4p"]},{t:"chiipon",tiles:["9s","9s","9s"]},{t:"chiipon",tiles:["4z","4z","4z"]}]})]})}),\u5BFE\u3005\u548C:g({id:"\u5BFE\u3005\u548C",name:"All Triplets"}),\u4E09\u8272\u540C\u523B:g({id:"\u4E09\u8272\u540C\u523B",name:"Triple Triplets"}),\u4E09\u6697\u523B:g({id:"\u4E09\u6697\u523B",name:"Three Concealed Triplets"}),\u4E09\u9023\u523B:g({id:"\u4E09\u9023\u523B",name:"Three Consecutive Triplets",type:"local",help:t("div",{className:"flex flex-col gap-2",children:[a("span",{children:"2 Han. A hand containing three triplets in the same suit where their number steps by 1."}),a(X,{tiles:["3p","3p","3p","5s","5s"],melds:[{t:"chiipon",tiles:["4p","4p","4p"]},{t:"chiipon",tiles:["5p","5p","5p"]},{t:"chiipon",tiles:["7z","7z","7z"]}]})]})}),\u4E09\u69D3\u5B50:g({id:"\u4E09\u69D3\u5B50",name:"Three Quads"}),\u5C0F\u4E09\u5143:g({id:"\u5C0F\u4E09\u5143",name:"Three Little Dragons"}),\u6DF7\u8001\u982D:g({id:"\u6DF7\u8001\u982D",name:"All Terminals and Honors"}),\u4E00\u8272\u4E09\u9806:g({id:"\u4E00\u8272\u4E09\u9806",name:"Pure Triple Sequence",type:"local",help:t("div",{className:"flex flex-col gap-2",children:[a("span",{children:"3 Han. Loses 1 Han if open. A hand containing three identical sequences in the same suit."}),a(X,{tiles:["1s","1s","1s","2s","2s","2s","3s","3s","3s","8p","8p","8p","1z","1z"]})]})}),\u7D14\u5168\u5E2F\u4E48\u4E5D:g({id:"\u7D14\u5168\u5E2F\u4E48\u4E5D",name:"Fully Outside Hand"}),\u6DF7\u4E00\u8272:g({id:"\u6DF7\u4E00\u8272",name:"Half Flush"}),\u4E8C\u76C3\u53E3:g({id:"\u4E8C\u76C3\u53E3",name:"Twice Pure Double Sequence"}),\u6E05\u4E00\u8272:g({id:"\u6E05\u4E00\u8272",name:"Full Flush"}),\u30C9\u30E9:g({id:"\u30C9\u30E9",name:"Dora",type:"extra"}),\u88CF\u30C9\u30E9:g({id:"\u88CF\u30C9\u30E9",name:"Uradora",type:"extra"}),\u8D64\u30C9\u30E9:g({id:"\u8D64\u30C9\u30E9",name:"Red Fives",type:"extra"}),\u629C\u304D\u30C9\u30E9:g({id:"\u629C\u304D\u30C9\u30E9",name:"Kita",type:"extra"}),\u4ED6\u306E\u5F79\u6E80:g({id:"\u4ED6\u306E\u5F79\u6E80",name:"Other Yakuman",type:"extra"}),\u4ED6\u306E\u5F79:g({id:"\u4ED6\u306E\u5F79",name:"Other Yaku",type:"extra"}),\u4ED6\u306E\u30C9\u30E9:g({id:"\u4ED6\u306E\u30C9\u30E9",name:"Other Dora",type:"extra"})},Ke=Object.fromEntries(Object.keys(Ye).map((e,r)=>[e,r])),he={m:["1m","2m","3m","4m","5m","6m","7m","8m","9m"],p:["1p","2p","3p","4p","5p","6p","7p","8p","9p"],s:["1s","2s","3s","4s","5s","6s","7s","8s","9s"],z:["1z","2z","3z","4z","5z","6z","7z"]};function re(e){const r={m:0,p:1,s:2,z:3};return e.sort((i,n)=>{const l=i[1],s=n[1];return r[l]-r[s]||(Number(i[0])||4.9)-(Number(n[0])||4.9)})}function ce(e){const r={m:0,p:1,s:2,z:3};return e.sort((i,n)=>{const l=i.tiles[0][1],s=n.tiles[0][1];return r[l]-r[s]||(Number(i.tiles[0][0])||4.9)-(Number(n.tiles[0][0])||4.9)})}function A(e,r=1,i){const n=i?3:4,l=r<0?n+r:r;return((Number(e[0])+l-1)%n+1).toString()}function en(e,r=1,i){const n=Number(e[0])||5,l=e[1];if(l==="z"){if(n<=4){const x=r<0?4+r:r;return`${(n+x-1)%4+1}z`}const c=r<0?3+r:r;return`${(n+c-5)%3+5}z`}if(i&&l==="m")return n===1?"9m":"1m";const s=r<0?9+r:r;return`${(n+s-1)%9+1}${l}`}function na(e){return{1:"East",2:"South",3:"West",4:"North"}[e]}function an(e){return Ye[e].name}function rn(e){var i;const r=parseInt(e,10);return r&&e.endsWith("\u5F79\u6E80")?`${(i=["Double","Triple","Quadruple","Quintuple","Sextuple"][r-2])!=null?i:`${r}x`} Yakuman`:{\u6E80\u8CAB:"Mangan",\u8DF3\u6E80:"Haneman",\u500D\u6E80:"Baiman",\u4E09\u500D\u6E80:"Sanbaiman",\u6570\u3048\u5F79\u6E80:"Counted Yakuman",\u5F79\u6E80:"Yakuman"}[e]}function nn(e,r,i){let n=r*Math.pow(2,e+2);return(i.kiriageMangan?n>=1920:n>2e3)&&(i.kazoeYakuman&&e>=13?n=8e3:e>=11?n=6e3:e>=8?n=4e3:e>=6?n=3e3:n=2e3),ln(n,i)}function ln(e,r){return{tsumoAsFromOya:I(e*2)+(r.sanma==="bisection"?I(I(e*2)/2):0),tsumoAsKo:I(e)+(r.sanma==="bisection"?I(I(e)/2):0),ronAsOya:I(e*6),ronAsKo:I(e*4)}}function I(e){return Math.ceil(e/100)*100}function tn(e,r,i,{tsumoAsFromOya:n,tsumoAsKo:l,ronAsOya:s,ronAsKo:c}){return r==="ron"?{agari:"ron",points:{total:e?s:c,oya:{ron:s},ko:{ron:c}}}:{agari:"tsumo",points:{total:e?n*(i?2:3):n+l*(i?1:2),oya:{ko:n},ko:{oya:n,ko:l}}}}function sn(e){let r="";const i=ke(e.tiles.filter((n,l)=>l!==e.agariIndex));for(const[n,l]of i)r+=l,r+=n;e.agari==="ron"&&(r+="+"),r+=e.tiles[e.agariIndex];for(const n of e.melds)if(r+="+",n.t==="chiipon"||!n.closed){for(const l of n.tiles)r+=l[0];r+=n.tiles[0][1]}else r+=n.tiles[0][0],r+=n.tiles[0][0],r+=n.tiles[0][1];if(e.dora.length){r+="+d";const n=ke(e.dora);for(const[l,s]of n)r+=s,r+=l}if(e.uradora.length){r+="+u";const n=ke(e.uradora);for(const[l,s]of n)r+=s,r+=l}return e.nukidora&&(r+="+n",r+=e.nukidora),e.extraYakuHan&&(r+="+xy",r+=e.extraYakuHan),e.extraDoraHan&&(r+="+xd",r+=e.extraDoraHan),e.extraYakuman&&(r+="+xm",r+=e.extraYakuman),r+="+",e.riichi&&(e.riichi.double?r+="w":r+="r",e.riichi.ippatsu&&(r+="i")),e.blessing&&(r+="t"),e.lastTile&&(r+="h"),e.kan&&(r+="k"),r+=e.roundWind,r+=e.seatWind,r}function ee(e,r){return r.dora.includes(e)||e[0]==="0"&&r.dora.includes(`5${e[1]}`)||r.uradora.includes(e)||e[0]==="0"&&r.uradora.includes(`5${e[1]}`)}function ke(e){const r={m:[],p:[],s:[],z:[]};for(const n of e)r[n[1]].push(n[0]);const i=[];for(const[n,l]of Object.entries(r))l.length&&i.push([n,l.join("")]);return i}function on(e,r){return{...r.isAgari?e.agari==="ron"?{agari:"ron",points:{total:r.ten,oya:{ron:r.oya[0]},ko:{ron:r.ko[0]}}}:{agari:"tsumo",points:{total:r.ten,oya:{ko:r.oya[0]},ko:{oya:r.ko[0],ko:r.ko[1]}}}:{agari:null},isOya:e.seatWind==="1",yakuman:r.yakuman,yaku:Object.entries(r.yaku).sort((n,l)=>Ke[n[0]]-Ke[l[0]]).map(([n,l])=>{var x;const s=an(n),c=l.endsWith("\u5F79\u6E80")?parseInt(l,10)||1:Number((x=/\d+/.exec(l))==null?void 0:x[0]);return[s,c,l.endsWith("\u5F79\u6E80")]}),noYaku:r.noYaku,han:r.han,fu:r.fu,name:r.name?rn(r.name):null}}function un(e,r){const i=sn(e),l=new xa(i,{multiYakuman:r.multiYakuman,wyakuman:r.doubleYakuman,kuitan:r.openTanyao,ryuuiisouHatsu:r.ryuuiisouHatsu,noYakuFu:r.noYakuFu,noYakuDora:r.noYakuDora,kiriageMangan:r.kiriageMangan,kazoeYakuman:r.kazoeYakuman,doubleWindFu:r.doubleWindFu,rinshanFu:r.rinshanFu,sanma:r.sanma!=null,sanmaBisection:r.sanma==="bisection",aka:r.akadora,disabledYaku:r.disabledYaku,localYaku:r.enabledLocalYaku}).calc();if(l.error)throw new Error("Invalid hand");return on(e,l)}function ia({result:e,pao:r}){return t("div",{className:"flex flex-col justify-center items-center gap-y-2",children:[e.name?a("div",{className:"text-4xl italic",children:e.name}):e.noYaku?a("div",{className:"text-4xl italic",children:"No Yaku"}):null,t("div",{className:"flex flex-row items-end gap-x-2",children:[a("span",{className:"text-6xl text-amber-700 dark:text-amber-500",children:e.points.total}),a("span",{className:"text-2xl",children:"Points"})]}),t("div",{className:"text-2xl",children:["Points to take:"," ",e.isOya?e.agari==="tsumo"?r?t("span",{children:[a("span",{className:"text-amber-700 dark:text-amber-500",children:e.points.total})," from liable"]}):t("span",{children:[a("span",{className:"text-amber-700 dark:text-amber-500",children:e.points.oya.ko})," all"]}):r?t("span",{children:[a("span",{className:"text-amber-700 dark:text-amber-500",children:I(e.points.oya.ron/2)})," from both"]}):a("span",{className:"text-amber-700 dark:text-amber-500",children:e.points.oya.ron}):e.agari==="tsumo"?r?t("span",{children:[a("span",{className:"text-amber-700 dark:text-amber-500",children:e.points.total})," from liable"]}):t(_,{children:[a("span",{className:"text-amber-700 dark:text-amber-500",children:e.points.ko.oya}),","," ",a("span",{className:"text-amber-700 dark:text-amber-500",children:e.points.ko.ko})]}):r?t("span",{children:[a("span",{className:"text-amber-700 dark:text-amber-500",children:I(e.points.ko.ron/2)})," from both"]}):a("span",{className:"text-amber-700 dark:text-amber-500",children:e.points.ko.ron})]})]})}function dn({tileCount:e,result:r,transferButton:i,pao:n,onTransferClick:l}){return a("div",{className:"w-full h-full flex flex-col justify-center items-center",children:e===14&&r?a(cn,{result:r,transferButton:i,pao:n,onTransferClick:l}):a("span",{className:"text-2xl lg:text-4xl text-center",children:"Not enough tiles to form a complete hand."})})}function cn({result:e,transferButton:r=!1,pao:i=!1,onTransferClick:n}){return a("div",{className:"flex flex-col justify-center items-center w-full h-full gap-y-2 lg:gap-y-4",children:e.agari==null?a("span",{className:"text-2xl lg:text-4xl text-center",children:"Tiles do not form a valid winning hand."}):t(_,{children:[a("div",{children:e.yakuman?a("span",{className:"text-4xl text-amber-700 dark:text-amber-500",children:"Yakuman"}):t("span",{className:"text-4xl",children:[a("span",{className:"text-amber-700 dark:text-amber-500",children:e.han})," Han"," ",a("span",{className:"text-amber-700 dark:text-amber-500",children:e.fu})," Fu"]})}),a("ul",{className:"flex flex-col text-lg container lg:w-[50%] gap-y-0.5",children:e.yaku.map(l=>t("li",{className:"flex flex-row items-center justify-between border-b border-dotted border-black dark:border-gray-50 dark:border-opacity-50 pb-0.5",children:[a("span",{className:"text-sm sm:text-lg md:text-xl lg:text-2xl",children:l[0]}),l[2]?a("span",{className:"text-sm sm:text-lg md:text-xl lg:text-2xl text-amber-700 dark:text-amber-500",children:l[1]>3?`${l[1]}\u2605`:"\u2605".repeat(l[1])}):t("span",{className:"text-sm sm:text-lg md:text-xl lg:text-2xl",children:[a("span",{className:"text-amber-700 dark:text-amber-500",children:l[1]})," Han"]})]},l[0]))}),a(ia,{result:e,pao:i}),r&&a("div",{className:"flex flex-col container lg:w-[50%]",children:a("button",{className:D("border border-gray-800 rounded-xl shadow py-1 lg:p-2 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600","w-full h-24 text-2xl","bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800"),onClick:n,children:"Transfer Calculated Score"})})]})})}function mn({meld:e,hand:r,onClick:i}){return a("div",{className:"flex flex-row gap-x-0.5 group",children:e.t==="chiipon"?e.tiles.map((n,l)=>a(W,{tile:n,onClick:i&&(()=>i(e)),dora:ee(n,r)},l)):e.closed?e.tiles.map((n,l)=>a(W,{tile:l===1||l===2?"00":n,onClick:i&&(()=>i(e)),dora:!(l===1||l===2)&&ee(n,r)},l)):e.tiles.map((n,l)=>a(W,{tile:n,onClick:i&&(()=>i(e)),dora:ee(n,r)},l))})}function hn({hand:e,onTileClick:r,onMeldClick:i}){return a("div",{className:"flex flex-row gap-2 justify-center items-center min-w-min",children:e.tiles.length||e.melds.length?t(_,{children:[a("div",{className:"flex flex-row justify-center items-center gap-x-0.5",children:e.tiles.map((n,l)=>a(W,{tile:n,agari:l===e.agariIndex,dora:ee(n,e),onClick:r&&(s=>r(s,l))},l))}),e.melds.map((n,l)=>a(mn,{meld:n,hand:e,onClick:i&&(s=>i(s,l))},l))]}):a("div",{className:"flex flex-row gap-x-0.5",children:Array.from({length:14},(n,l)=>a(ra,{},l))})})}function qe({dora:e,onTileClick:r}){return a("div",{className:"flex flex-row gap-x-2 justify-center items-center min-w-min",children:a("div",{className:"flex flex-row gap-x-0.5",children:e.length?e.map((i,n)=>a(W,{tile:i,dora:!0,onClick:r&&(l=>r(l,n))},n)):a(ra,{})})})}function ve({suit:e,hand:r,allTiles:i,action:n,tileCount:l,akadora:s,sanma:c,onClick:x}){return t("div",{className:"flex flex-row gap-1 lg:gap-2 justify-center items-center min-w-min",children:[(c&&e==="m"?[he[e][0],he[e][8]]:he[e]).map(f=>a(W,{tile:f,onClick:x,dora:ee(f,r),disabled:Ne(f,n,r,l,i,c)},f)),s&&!c&&a(W,{tile:`0${e}`,onClick:x,dora:ee(`0${e}`,r),disabled:Ne(`0${e}`,n,r,l,i,!1)})]})}function gn({onClick:e,hand:r,allTiles:i,action:n,tileCount:l}){return a("div",{className:"flex flex-row gap-1 lg:gap-2 justify-center items-center min-w-min",children:he.z.map(s=>a(W,{tile:s,dora:ee(s,r),disabled:Ne(s,n,r,l,i,!1),onClick:e},s))})}function Ne(e,r,i,n,l,s){if((r==null?void 0:r.t)==="dora"||(r==null?void 0:r.t)==="uradora"){const x=en(e,-1,s);return Ue(x,i,l)>=4}if(n>=14||e[0]==="0"&&l.some(x=>x===e))return!0;const c=Ue(e,i,l);if(c>=4)return!0;if(e[1]==="z"){if(r)return r.t==="chii"||(r.t==="pon"?c>=2:c>=1)}else if(r){if(r.t==="chii"){if(r.tiles.length===0)return!1;const x=Number(e[0])||5;return!(r.tiles.length===1?[(Number(r.tiles[0][0])||5)-1,(Number(r.tiles[0][0])||5)+1]:[(Number(r.tiles[0][0])||5)-1,(Number(r.tiles[1][0])||5)+1]).includes(x)}return r.t==="pon"?c>=2:c>=1}return!1}function Ue(e,r,i){return e[0]==="0"||e[0]==="5"?i.filter(n=>n===`0${e[1]}`||n===`5${e[1]}`).length:e==="4z"?i.filter(n=>n===e).length+r.nukidora:i.filter(n=>n===e).length}function Ce({value:e,redEast:r=!1,forced:i=!1,sanma:n,onChange:l}){return a(W,{tile:`${e}z`,red:r&&e==="1",forced:i,onClick:l&&(()=>{l(A(e,1,n))})})}function la(){return t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}function ta(){return a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}function fn({children:e}){return a("div",{className:"w-full overflow-x-auto",children:a("div",{className:"w-full flex flex-col justify-center items-center gap-2 min-w-min px-2",children:e})})}function De(){return t("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[t("rect",{x:"1",y:"1",rx:"1",width:"10",height:"10",children:[a("animate",{id:"a",begin:"0;l.end",attributeName:"x",dur:"0.2s",values:"1;13",fill:"freeze"}),a("animate",{id:"d",begin:"c.end",attributeName:"y",dur:"0.2s",values:"1;13",fill:"freeze"}),a("animate",{id:"g",begin:"f.end",attributeName:"x",dur:"0.2s",values:"13;1",fill:"freeze"}),a("animate",{id:"j",begin:"i.end",attributeName:"y",dur:"0.2s",values:"13;1",fill:"freeze"})]}),t("rect",{x:"1",y:"13",rx:"1",width:"10",height:"10",children:[a("animate",{id:"b",begin:"a.end",attributeName:"y",dur:"0.2s",values:"13;1",fill:"freeze"}),a("animate",{id:"e",begin:"d.end",attributeName:"x",dur:"0.2s",values:"1;13",fill:"freeze"}),a("animate",{id:"h",begin:"g.end",attributeName:"y",dur:"0.2s",values:"1;13",fill:"freeze"}),a("animate",{id:"k",begin:"j.end",attributeName:"x",dur:"0.2s",values:"13;1",fill:"freeze"})]}),t("rect",{x:"13",y:"13",rx:"1",width:"10",height:"10",children:[a("animate",{id:"c",begin:"b.end",attributeName:"x",dur:"0.2s",values:"13;1",fill:"freeze"}),a("animate",{id:"f",begin:"e.end",attributeName:"y",dur:"0.2s",values:"13;1",fill:"freeze"}),a("animate",{id:"i",begin:"h.end",attributeName:"x",dur:"0.2s",values:"1;13",fill:"freeze"}),a("animate",{id:"l",begin:"k.end",attributeName:"y",dur:"0.2s",values:"1;13",fill:"freeze"})]})]})}function sa(){return a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:a("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})}function pn(){return a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}function Q({onClose:e,initialFocus:r,title:i,children:n}){return t(Pe,{open:!0,onClose:e,initialFocus:r,children:[a("div",{className:"fixed inset-0 bg-black/70","aria-hidden":"true"}),a("div",{className:"fixed inset-0 flex flex-col justify-center items-center",children:a("div",{className:"flex flex-col justify-center items-center",children:a(Pe.Panel,{className:"max-w-[100vw] max-h-screen",children:t("div",{className:"text-black dark:text-white flex flex-col max-w-[100vw] max-h-screen px-4 py-8",children:[t("div",{className:"flex flex-row justify-between items-center w-full bg-slate-400 dark:bg-gray-700 rounded-t-xl p-2",children:[a("div",{className:"text-xl lg:text-3xl font-bold ml-1 lg:ml-2",children:i}),a(ae,{onClick:e,children:a(pn,{})})]}),a("div",{className:"bg-slate-200 dark:bg-gray-900 rounded-b-xl shadow overflow-auto py-4 px-4 lg:px-8",children:n})]})})})})]})}function _e({yakuList:e,inverted:r,local:i,onChange:n,onClose:l}){return a(Q,{title:i?"Toggle Local Yaku":"Toggle Yaku",onClose:l,children:t("div",{className:"flex flex-col justify-center items-center gap-y-8",children:[a("div",{className:"flex flex-col gap-2",children:Object.values(Ye).filter(s=>i?s.type==="local":s.type==="optional").map(s=>a(bn,{inverted:r,yakuList:e,yaku:s,onChange:n},s.id))}),a(v,{onClick:()=>{l()},children:"Close"})]})})}function bn({inverted:e,yakuList:r,yaku:i,onChange:n}){function l(x){const f=Qe(x)(r);n==null||n(f)}const[s,c]=w.exports.useState(!1);return t("div",{className:"flex flex-row justify-center items-center gap-2",children:[a("button",{className:D("border border-gray-800 rounded-xl shadow p-1 lg:p-2 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600","w-52 lg:w-80 h-10 lg:h-14 text-base lg:text-xl",(e?!r.has(i.id):r.has(i.id))?"bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800":"bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600"),onClick:x=>{x.preventDefault(),l(f=>{let k;switch(i.id){case"\u6D77\u5E95\u6478\u6708":case"\u6CB3\u5E95\u6488\u9B5A":k=["\u6D77\u5E95\u6478\u6708","\u6CB3\u5E95\u6488\u9B5A"];break;case"\u5DBA\u4E0A\u958B\u82B1":case"\u6436\u69D3":k=["\u5DBA\u4E0A\u958B\u82B1","\u6436\u69D3"];break;default:k=[i.id]}for(const o of k)f.has(o)?f.delete(o):f.add(o)})},children:i.name}),i.help&&a(xn,{highlight:s,onClick:()=>c(!0)}),s&&a(Q,{title:i.name,onClose:()=>c(!1),children:a("div",{className:"text-lg lg:text-xl",children:i.help})})]},i.id)}function xn({highlight:e,onClick:r}){return a("button",{className:D("border border-gray-800 rounded-full p-1 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600",e?"bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800":"bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600"),onClick:i=>{i.preventDefault(),r==null||r()},children:a("div",{className:"w-6 h-6 lg:w-8 lg:h-8 flex flex-col justify-center items-center",children:a(sa,{})})})}const oa=w.exports.createContext(null);function U(){return w.exports.useContext(oa)}function kn({children:e,repository:r}){return a(oa.Provider,{value:r(),children:e})}function vn(){return a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}function ua({settings:e,inCalculator:r,allowCopy:i=!1,onSettingsChange:n,onClose:l}){const c=U().useSettings("$global",{enabled:i}),[x,f]=w.exports.useState(!1),[k,o]=w.exports.useState(!1);function m(d){const p=Qe(d)(e);n==null||n(p)}return a(Q,{title:"Settings",onClose:l,children:t("div",{className:"flex flex-col justify-center items-center gap-y-8",children:[t("div",{className:"flex flex-col justify-center items-center gap-y-2",children:[t(j,{name:"Game Mode",help:t("span",{children:["The number of players in the game. ",a("br",{}),a(K,{children:"Three-Player"})," mahjong uses the sanma rules, which includes no chii, no 2 to 8 of Man, and Kita."]}),children:[a(v,{active:e.sanma==null,onClick:()=>m(d=>{d.sanma=null}),children:"Four-Player"}),a(v,{active:e.sanma!=null,onClick:()=>m(d=>{d.sanma="loss"}),children:"Three-Player"})]}),e.sanma!=null&&t(j,{name:"Tsumo Points",help:t("span",{children:["The distribution of points when a player wins with tsumo.",a("br",{}),"If ",a(K,{children:"Loss"})," is enabled, the base points are the same as in four player. In effect, the winning player loses the points from the missing North player.",a("br",{}),"If ",a(K,{children:"Bisection"})," is enabled, the base points will include the points from the North player that should have been paid. In effect, the other two players will pay more."]}),children:[a(v,{active:e.sanma==="loss",onClick:()=>m(d=>{d.sanma="loss"}),children:"Loss"}),a(v,{active:e.sanma==="bisection",onClick:()=>m(d=>{d.sanma="bisection"}),children:"Bisection"})]}),t(j,{name:"Red Fives",help:a("span",{children:"The number of red fives available in the calculator when building a hand."}),children:[t(v,{active:e.akadora,onClick:()=>m(d=>{d.akadora=!0}),children:[e.sanma?"2":"3"," Red Fives"]}),a(v,{active:!e.akadora,onClick:()=>m(d=>{d.akadora=!1}),children:"0 Red Fives"})]}),t(j,{name:"Toggle Yaku",help:t("span",{children:["Toggle the yaku available in the calculator. ",a("br",{}),a(K,{children:"Optional Yaku"})," are some of the usual yaku, enabled by default. They may be disabled if needed. ",a("br",{}),a(K,{children:"Local Yaku"})," are generally less common and are disabled by default. ",a("br",{})]}),children:[t(v,{onClick:()=>f(!0),children:["Optional Yaku (-",e.disabledYaku.length,")"]}),t(v,{onClick:()=>o(!0),children:["Local Yaku (+",e.enabledLocalYaku.length,")"]}),x&&a(_e,{yakuList:new Set(e.disabledYaku),onChange:d=>m(p=>{p.disabledYaku=[...d]}),inverted:!0,local:!1,onClose:()=>f(!1)}),k&&a(_e,{yakuList:new Set(e.enabledLocalYaku),onChange:d=>m(p=>{p.enabledLocalYaku=[...d]}),inverted:!1,local:!0,onClose:()=>o(!1)})]}),t(j,{name:"Other Scoring",help:t("span",{children:["Whether to show counters to add in extra Yaku, Dora, and Yakuman. ",a("br",{}),"These can be used for purposes such as extra red fives and other dora, and unsupported local yaku."]}),children:[a(v,{active:e.otherScoring,onClick:()=>m(d=>{d.otherScoring=!0}),children:"Show"}),a(v,{active:!e.otherScoring,onClick:()=>m(d=>{d.otherScoring=!1}),children:"Hide"})]}),!r&&t(j,{name:"Pao Payment",compass:!0,help:t("span",{children:["Whether to show the ability to distribute points using pao. ",a("br",{}),"This is used when a player aids in the creation of a Yakuman. ",a("br",{}),"With tsumo, the responsible player will pay full amount. ",a("br",{}),"With ron, the responsible player and the player who dealt in will each pay half."]}),children:[a(v,{active:e.usePao,onClick:()=>m(d=>{d.usePao=!0}),children:"Show"}),a(v,{active:!e.usePao,onClick:()=>m(d=>{d.usePao=!1}),children:"Hide"})]}),t(j,{name:"Rounded Mangan",help:t("span",{children:["Whether to round up hands worth 4 Han 30 Fu or 3 Han 60 Fu to a Mangan. ",a("br",{}),"Otherwise, they are worth the usual 2000/3900 and 7700 (non-dealer) or 3900 and 11600 (dealer)."]}),children:[a(v,{active:e.kiriageMangan,onClick:()=>m(d=>{d.kiriageMangan=!0}),children:"Rounded"}),a(v,{active:!e.kiriageMangan,onClick:()=>m(d=>{d.kiriageMangan=!1}),children:"No Rounding"})]}),t(j,{name:"Counted Yakuman",help:t("span",{children:["Whether to count a hand worth at least 13 Han as ",a(K,{children:"Yakuman"})," or as"," ",a(K,{children:"Sanbaiman"}),"."]}),children:[a(v,{active:e.kazoeYakuman,onClick:()=>m(d=>{d.kazoeYakuman=!0}),children:"Yakuman"}),a(v,{active:!e.kazoeYakuman,onClick:()=>m(d=>{d.kazoeYakuman=!1}),children:"Sanbaiman"})]}),t(j,{name:"Yakuman Stacking",help:a("span",{children:"Whether to allow stacking multiple Yakuman together or cap the max at a single Yakuman."}),children:[a(v,{active:e.multiYakuman,onClick:()=>m(d=>{d.multiYakuman=!0}),children:"Allow"}),a(v,{active:!e.multiYakuman,onClick:()=>m(d=>{d.multiYakuman=!1}),children:"Disallow"})]}),e.multiYakuman&&t(j,{name:"Double Yakuman",help:t("span",{children:["Whether to count certain special yaku as being worth a double Yakuman. ",a("br",{}),"These include: ",a("br",{}),t("ul",{className:"list-disc list-inside",children:[a("li",{className:"list-item",children:"Big Four Winds"}),a("li",{className:"list-item",children:"Thirteen-Wait Thirteen Orphans"}),a("li",{className:"list-item",children:"True Nine Gates"}),a("li",{className:"list-item",children:"Single-Wait Four Concealed Triplets"})]})]}),children:[a(v,{active:e.doubleYakuman,onClick:()=>m(d=>{d.doubleYakuman=!0}),children:"Allow"}),a(v,{active:!e.doubleYakuman,onClick:()=>m(d=>{d.doubleYakuman=!1}),children:"Disallow"})]}),t(j,{name:"Open All Simples",help:a("span",{children:"Whether to allow the All Simples yaku to be counted if the hand has open melds."}),children:[a(v,{active:e.openTanyao,onClick:()=>m(d=>{d.openTanyao=!0}),children:"Allow"}),a(v,{active:!e.openTanyao,onClick:()=>m(d=>{d.openTanyao=!1}),children:"Disallow"})]}),t(j,{name:"All Green's Dragon",help:a("span",{children:"Whether to require the Green Dragon to count the All Green yaku."}),children:[a(v,{active:e.ryuuiisouHatsu,onClick:()=>m(d=>{d.ryuuiisouHatsu=!0}),children:"Required"}),a(v,{active:!e.ryuuiisouHatsu,onClick:()=>m(d=>{d.ryuuiisouHatsu=!1}),children:"Optional"})]}),t(j,{name:"Double Wind Fu",help:t("span",{children:["Whether to count a wind pair that is both the Prevalent Wind and the Seat Wind as"," ",a(K,{children:"4 Fu"})," or ",a(K,{children:"2 Fu"}),"."]}),children:[a(v,{active:e.doubleWindFu,onClick:()=>m(d=>{d.doubleWindFu=!0}),children:"4 Fu"}),a(v,{active:!e.doubleWindFu,onClick:()=>m(d=>{d.doubleWindFu=!1}),children:"2 Fu"})]}),t(j,{name:"After a Kan Fu",help:t("span",{children:["Whether to count the ",a(K,{children:"2 Fu"})," granted by tsumo if the hand won with After a Kan."]}),children:[a(v,{active:e.rinshanFu,onClick:()=>m(d=>{d.rinshanFu=!0}),children:"2 Fu"}),a(v,{active:!e.rinshanFu,onClick:()=>m(d=>{d.rinshanFu=!1}),children:"0 Fu"})]}),t(j,{name:"No Yaku Fu",help:a("span",{children:"Whether to calculate Fu even when with No Yaku. Hands will have 0 Han."}),children:[a(v,{active:e.noYakuFu,onClick:()=>m(d=>{d.noYakuFu=!0}),children:"Allow"}),a(v,{active:!e.noYakuFu,onClick:()=>m(d=>{d.noYakuFu=!1}),children:"Disallow"})]}),t(j,{last:!0,name:"No Yaku Dora",help:a("span",{children:"Whether to calculate Dora even when with No Yaku."}),children:[a(v,{active:e.noYakuDora,onClick:()=>m(d=>{d.noYakuDora=!0}),children:"Allow"}),a(v,{active:!e.noYakuDora,onClick:()=>m(d=>{d.noYakuDora=!1}),children:"Disallow"})]})]}),t("div",{className:"flex flex-col justify-center items-center gap-y-2",children:[i&&(c==null?void 0:c.ok)&&a(v,{onClick:()=>{m(()=>c.value)},children:"Copy From Calculator"}),a(v,{onClick:()=>{l()},children:"Close"})]})]})})}function j({name:e,help:r,compass:i=!1,last:n=!1,children:l}){const[s,c]=w.exports.useState(!1);return t("div",{className:D("flex flex-row flex-wrap lg:flex-nowrap justify-center items-center gap-2",!n&&"border-b-2 border-dashed border-gray-800 pb-2"),children:[t("div",{className:"flex flex-row justify-between items-center gap-2 w-[15rem] lg:w-[20rem]",children:[t("span",{className:"relative text-xl lg:text-2xl",children:[e,i&&a("span",{className:"absolute mx-1 h-4 w-4",children:a(vn,{})})]}),a(yn,{highlight:s,onClick:()=>c(!s)})]}),a("div",{className:"flex flex-row flex-wrap gap-2 justify-center items-start w-[14rem] md:w-[27rem] lg:w-[41rem]",children:l}),s&&a(Q,{title:e,onClose:()=>c(!1),children:a("div",{className:"text-lg lg:text-xl",children:r})})]})}function yn({highlight:e,onClick:r}){return a("button",{className:D("border border-gray-800 rounded-full p-1 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600",e?"bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800":"bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600"),onClick:i=>{i.preventDefault(),r==null||r()},children:a("div",{className:"w-6 h-6 lg:w-8 lg:h-8 flex flex-col justify-center items-center",children:a(sa,{})})})}function K({children:e}){return a("span",{className:"text-amber-700 dark:text-amber-500",children:e})}function wn(e){switch(e){case"chii":return{t:e,tiles:[]};default:return{t:e}}}function Nn(){var s,c;const r=(s=Ve().state)!=null?s:null,i=U(),n=i.useSettings("$global",{enabled:(r==null?void 0:r.t)==="load"}),l=i.useGame((c=r==null?void 0:r.id)!=null?c:"",{enabled:(r==null?void 0:r.t)==="transfer"});return a("div",{className:"min-h-screen bg-slate-200 dark:bg-gray-900 text-black dark:text-white",children:(r==null?void 0:r.t)==="transfer"?l==null?a("div",{className:"w-screen h-screen flex flex-col justify-center items-center",children:a("div",{className:"fill-black dark:fill-white w-24 h-24",children:a(De,{})})}):l.ok?a(ye,{locState:r,globalSettings:null,game:l.value}):a("div",{className:"w-screen h-screen flex flex-col justify-center items-center",children:t("div",{className:"text-red-600 dark:text-red-700 font-mono",children:["Error: Game ",r.id," does not exist."]})}):(r==null?void 0:r.t)==="load"?n==null?a("div",{className:"w-screen h-screen flex flex-col justify-center items-center",children:a("div",{className:"fill-black dark:fill-white w-24 h-24",children:a(De,{})})}):n.ok?a(ye,{locState:r,globalSettings:n.value,game:null}):a("div",{className:"w-screen h-screen flex flex-col justify-center items-center",children:t("div",{className:"text-red-600 dark:text-red-700 font-mono",children:["Error: Settings ",r.id," does not exist."]})}):a(ye,{locState:r,globalSettings:null,game:null})})}function ye({locState:e,globalSettings:r,game:i}){var Ae,We,je,Te,ze,Re,Me;const n=se(),l=U(),s=i?i.settings:r,[c,x]=w.exports.useState(!1),f=s.sanma!=null,k={tiles:[],melds:[],agariIndex:-1,agari:(e==null?void 0:e.t)==="transfer"?e.agari:"tsumo",dora:[],uradora:[],nukidora:0,extraYakuHan:0,extraDoraHan:0,extraYakuman:0,riichi:i&&(e==null?void 0:e.t)==="transfer"&&i.riichi[e.winner]?{double:!1,ippatsu:!1}:null,blessing:!1,lastTile:!1,kan:!1,roundWind:(e==null?void 0:e.t)==="transfer"?e.roundWind:"1",seatWind:(e==null?void 0:e.t)==="transfer"?e.seatWind:"1"},[o,m]=we(k),[d,p]=we(null),Y=u=>{if(!d){m(b=>{if(s.akadora&&u[0]==="5"&&o.tiles.filter(B=>B===u).length===3){b.tiles.push(`0${u[1]}`),re(b.tiles);const B=b.tiles.findIndex(ie=>ie===`0${u[1]}`);b.agariIndex=B}else{b.tiles.push(u),re(b.tiles);const B=b.tiles.findIndex(ie=>ie===u);b.agariIndex=B}});return}const h=()=>{if(u[0]==="0"){const b=`5${u[1]}`;return[u,b,b]}return s.akadora&&u[0]==="5"&&o.tiles.some(b=>b===u)?[`0${u[1]}`,u,u]:[u,u,u]},C=()=>{if(u[0]==="0"){const b=`5${u[1]}`;return[u,b,b,b]}return s.akadora&&u[0]==="5"?[`0${u[1]}`,u,u,u]:[u,u,u,u]};switch(d.t){case"dora":{m(b=>{b.dora.push(u),p(null)});break}case"uradora":{m(b=>{b.uradora.push(u),p(null)});break}case"chii":{d.tiles.length===0&&p({t:"chii",tiles:[u]}),d.tiles.length===1&&p({t:"chii",tiles:re([d.tiles[0],u])}),d.tiles.length===2&&(m(b=>{b.melds.push({t:"chiipon",tiles:re([...d.tiles,u])}),ce(b.melds),b.riichi&&(b.riichi=null)}),p(null));break}case"pon":{m(b=>{b.melds.push({t:"chiipon",tiles:h()}),ce(b.melds),b.riichi&&(b.riichi=null)}),p(null);break}case"kan":{m(b=>{b.melds.push({t:"kan",closed:!1,tiles:C()}),ce(b.melds),b.riichi&&(b.riichi=null)}),p(null);break}case"closedKan":{m(b=>{var B;b.melds.push({t:"kan",closed:!0,tiles:C()}),ce(b.melds),((B=b.riichi)==null?void 0:B.double)&&b.riichi.ippatsu&&(b.riichi.ippatsu=!1)}),p(null);break}}},N=o.tiles.length+o.melds.length*3,F=o.tiles.concat(o.melds.flatMap(u=>u.tiles)).concat((d==null?void 0:d.t)==="chii"?d.tiles:[]),[T,$]=w.exports.useState(null),[E,z]=w.exports.useState(null),[V,R]=w.exports.useState(null),S=N===14?un(o,s):null,[P,y]=w.exports.useState(1),[L,da]=w.exports.useState(30),Be=tn(o.seatWind==="1",o.agari,f,nn(P,L,s)),Fe=async u=>{if(i==null||(e==null?void 0:e.t)!=="transfer"||e.agari!==u.agari)return;const{bottomWind:h,roundWind:C,round:b,repeats:B,scores:ie,riichi:ca,riichiSticks:ge}=i,oe=f?200:300,ma=f?[0,1,2]:[0,1,2,3],He=f?3:4,Z=e.seatWind==="1",M=ie.slice(0);if(M[e.winner]+=u.points.total,e.scoreRepeatSticks&&ge&&(M[e.winner]+=1e3*ge),e.scoreRepeatSticks&&!Z&&(M[e.winner]+=B*oe),e.agari==="ron"&&u.agari==="ron")if(e.pao==null){const G=Z?u.points.oya:u.points.ko;M[e.dealtInPlayer]-=G.ron,e.scoreRepeatSticks&&!Z&&(M[e.dealtInPlayer]-=B*oe)}else{const G=I(u.points.total/2);M[e.dealtInPlayer]-=G,M[e.pao]-=G,e.scoreRepeatSticks&&!Z&&(M[e.dealtInPlayer]-=B*oe)}else if(e.agari==="tsumo"&&u.agari==="tsumo")if(e.pao==null)for(const G of ma.filter(fe=>fe!==e.winner)){const fe=Z?u.points.oya.ko:A(h,G,f)==="1"?u.points.ko.oya:u.points.ko.ko;M[G]-=fe,e.scoreRepeatSticks&&!Z&&(M[G]-=B*100)}else{const G=u.points.total;M[e.pao]-=G,e.scoreRepeatSticks&&!Z&&(M[e.pao]-=B*oe)}const ha=e.handleRotation,le=e.seatWind==="1"&&e.dealerRepeat;await l.setGame(e.id,{...i,...ha||le?{bottomWind:le?h:A(h,-1,f),roundWind:le?C:b===He?A(C,1,f):C,round:le?b:b===He?1:b+1,repeats:le?B+1:0}:{},scores:M,riichiSticks:e.scoreRiichiSticks?0:ge,riichi:e.scoreRiichiSticks?te(!1,f?3:4):ca});const ga={t:"load",id:e.id};n("/compass",{state:ga,replace:!0})};return a("div",{className:"flex flex-row justify-center",children:t("div",{className:"w-full h-screen overflow-y-auto",children:[a("div",{className:"fixed top-2 left-2 lg:top-4 lg:left-4 flex flex-col gap-y-2",children:a(ae,{onClick:()=>{if((e==null?void 0:e.t)==="transfer"){const u={t:"load",id:e.id};n("/compass",{state:u,replace:!0})}else n("/",{replace:!0})},children:a(ta,{})})}),i==null&&a("div",{className:"fixed top-2 right-2 lg:top-4 lg:right-8 flex flex-col gap-y-2",children:a(ae,{onClick:()=>{x(!0)},children:a(la,{})})}),t("div",{className:"invisible sm:visible fixed bottom-2 right-2 lg:bottom-4 lg:right-8 flex flex-col gap-y-2",children:[a(xe,{element:T,children:"\u724C"}),a(xe,{element:E,highlight:(S==null?void 0:S.agari)!=null,children:"\u5F79"}),a(xe,{element:V,children:"\u70B9"})]}),c&&a(ua,{inCalculator:!0,settings:s,onSettingsChange:u=>{(async()=>(await l.setSettings("$global",u),m(k)))()},onClose:()=>{x(!1)}}),t("div",{className:"flex flex-col justify-center items-center w-full gap-y-2",children:[t("div",{ref:$,className:"flex flex-col justify-center items-center w-full min-h-screen gap-y-2 px-2 py-2",children:[t("div",{className:"flex flex-row gap-x-2 items-end",children:[a("h1",{className:"text-2xl lg:text-4xl",children:"Score Calculator"}),N>0&&a("button",{onClick:()=>{p(null),m(k)},className:"text-red-600 hover:text-red-700 dark:text-red-700 dark:hover:text-red-800",children:"Clear"})]}),a(O,{children:a(hn,{hand:o,onTileClick:(u,h)=>{p(null),m(C=>{C.tiles.splice(h,1),C.agariIndex>=h&&(C.agariIndex-=1)})},onMeldClick:(u,h)=>{p(null),m(C=>{C.melds.splice(h,1),u.t==="kan"&&C.agari==="tsumo"&&!C.melds.some(b=>b.t==="kan")&&!C.nukidora&&(C.kan=!1)})}})}),t(O,{children:[!f&&a(ne,{t:"chii",disabled:o.riichi!=null||o.blessing||N+3>14,currentAction:d,onActionChange:p,children:"Chii"}),a(ne,{t:"pon",disabled:o.riichi!=null||o.blessing||N+3>14,currentAction:d,onActionChange:p,children:"Pon"}),a(ne,{t:"kan",disabled:o.riichi!=null||o.blessing||N+3>14,currentAction:d,onActionChange:p,children:"Kan"}),a(ne,{t:"closedKan",disabled:o.blessing||N+3>14,currentAction:d,onActionChange:p,children:"Closed Kan"})]}),t(fn,{children:[a(ve,{suit:"m",akadora:s.akadora,hand:o,allTiles:F,tileCount:N,action:d,sanma:f,onClick:Y}),a(ve,{suit:"p",akadora:s.akadora,hand:o,allTiles:F,tileCount:N,action:d,sanma:f,onClick:Y}),a(ve,{suit:"s",akadora:s.akadora,hand:o,allTiles:F,tileCount:N,action:d,sanma:f,onClick:Y}),a(gn,{hand:o,allTiles:F,tileCount:N,action:d,onClick:Y})]}),a("div",{className:"w-full overflow-x-auto mb-1",children:t("div",{className:"flex flex-row gap-x-8 justify-center items-center min-w-min",children:[t("div",{className:"flex flex-col justify-center items-center gap-y-1",children:[a("span",{className:"text-xl",children:"Round"}),a(Ce,{forced:(e==null?void 0:e.t)==="transfer",value:o.roundWind,redEast:!0,sanma:f,onChange:u=>{p(null),m(h=>{h.roundWind=u})}})]}),t("div",{className:"flex flex-col justify-center items-center gap-y-1",children:[a("span",{className:"text-xl",children:"Seat"}),a(Ce,{forced:(e==null?void 0:e.t)==="transfer",value:o.seatWind,redEast:!0,sanma:f,onChange:u=>{p(null),m(h=>{h.seatWind=u})}})]}),t("div",{className:"flex flex-col justify-center items-center gap-y-1",children:[a("span",{className:"text-xl",children:"Dora"}),a(qe,{dora:o.dora,onTileClick:(u,h)=>{p(null),m(C=>{C.dora.splice(h,1),re(C.dora)})}})]}),t("div",{className:"flex flex-col justify-center items-center gap-y-1",children:[a("span",{className:"text-xl",children:"Uradora"}),a(qe,{dora:o.uradora,onTileClick:(u,h)=>{p(null),m(C=>{C.uradora.splice(h,1),re(C.uradora)})}})]})]})}),t(O,{children:[a(Se,{forced:(e==null?void 0:e.t)==="transfer",toggled:o.agari==="ron",onToggle:u=>{p(null),m(h=>{h.agari=u?"ron":"tsumo",h.agari==="tsumo"&&!o.melds.some(C=>C.t==="kan")&&(h.kan=!1)})},left:"Tsumo",right:"Ron"}),a(ne,{t:"dora",disabled:o.dora.length>=5,currentAction:d,onActionChange:p,children:"Add Dora"}),a(ne,{t:"uradora",disabled:o.riichi==null||o.uradora.length>=5,currentAction:d,onActionChange:p,children:"Add Uradora"}),f&&t(J,{canDecrement:o.nukidora>0,onDecrement:()=>{p(null),m(u=>{u.nukidora--})},canIncrement:o.nukidora+F.filter(u=>u==="4z").length<4,onIncrement:()=>{p(null),m(u=>{u.nukidora++})},children:["Kita (",o.nukidora,")"]})]}),t(O,{children:[a(H,{toggled:o.riichi!=null,disabled:o.melds.filter(u=>u.t!=="kan"||!u.closed).length>0,incompatible:o.blessing,onToggle:u=>{p(null),m(h=>{h.riichi=u?{double:!1,ippatsu:!1}:null,u?h.blessing=!1:h.uradora=[]})},children:"Riichi"}),!s.disabledYaku.includes("\u30C0\u30D6\u30EB\u7ACB\u76F4")&&a(H,{toggled:(We=(Ae=o.riichi)==null?void 0:Ae.double)!=null?We:!1,disabled:o.melds.filter(u=>u.t!=="kan"||!u.closed).length>0,incompatible:o.riichi==null||o.riichi.ippatsu&&o.melds.filter(u=>u.t==="kan"&&u.closed).length>0||o.riichi.ippatsu&&o.lastTile,onToggle:u=>{p(null),m(h=>{var C,b;u&&h.riichi==null&&(h.riichi={double:!0,ippatsu:!1}),h.riichi.double=u,u&&(((C=h.riichi)==null?void 0:C.ippatsu)&&o.melds.filter(B=>B.t==="kan"&&B.closed).length>0&&(h.riichi.ippatsu=!1),((b=h.riichi)==null?void 0:b.ippatsu)&&h.lastTile&&(h.lastTile=!1))})},children:"Double Riichi"}),!s.disabledYaku.includes("\u4E00\u767A")&&a(H,{toggled:(Te=(je=o.riichi)==null?void 0:je.ippatsu)!=null?Te:!1,disabled:o.melds.filter(u=>u.t!=="kan"||!u.closed).length>0,incompatible:o.riichi==null||o.riichi.double&&o.melds.filter(u=>u.t==="kan"&&u.closed).length>0||o.agari==="tsumo"&&o.kan||o.agari==="ron"&&o.lastTile||o.lastTile&&o.riichi.double,onToggle:u=>{p(null),m(h=>{var C,b;u&&h.riichi==null&&(h.riichi={double:!1,ippatsu:!0}),h.riichi.ippatsu=u,u&&(h.agari==="tsumo"&&(h.kan=!1),h.agari==="ron"&&(h.lastTile=!1),((C=h.riichi)==null?void 0:C.double)&&o.melds.filter(B=>B.t==="kan"&&B.closed).length>0&&(h.riichi.double=!1),h.lastTile&&((b=h.riichi)==null?void 0:b.double)&&(h.lastTile=!1))})},children:"Ippatsu"})]}),t(O,{children:[(!s.disabledYaku.includes("\u5DBA\u4E0A\u958B\u82B1")||!s.disabledYaku.includes("\u6436\u69D3"))&&a(H,{toggled:o.kan,disabled:o.agari==="tsumo"&&!o.melds.some(u=>u.t==="kan")&&!o.nukidora||o.agari==="ron"&&o.melds.filter(u=>u.t==="kan").length===4||o.agari==="ron"&&o.tiles.filter(u=>o.tiles[o.agariIndex]===u).length>1,incompatible:o.blessing||o.agari==="tsumo"&&((ze=o.riichi)==null?void 0:ze.ippatsu)||o.lastTile,onToggle:u=>{p(null),m(h=>{h.kan=u,u&&(h.blessing=!1,h.lastTile=!1,h.agari==="tsumo"&&h.riichi&&(h.riichi.ippatsu=!1))})},children:o.agari==="ron"?"Robbing a Kan":"After a Kan"}),(!s.disabledYaku.includes("\u6D77\u5E95\u6478\u6708")||!s.disabledYaku.includes("\u6CB3\u5E95\u6488\u9B5A"))&&a(H,{toggled:o.lastTile,incompatible:o.blessing||o.agari==="ron"&&((Re=o.riichi)==null?void 0:Re.ippatsu)||o.kan||((Me=o.riichi)==null?void 0:Me.double)&&o.riichi.ippatsu,onToggle:u=>{p(null),m(h=>{var C;h.lastTile=u,u&&(h.blessing=!1,h.kan=!1,h.agari==="ron"&&h.riichi&&(h.riichi.ippatsu=!1),((C=h.riichi)==null?void 0:C.double)&&h.riichi.ippatsu&&(h.riichi.ippatsu=!1))})},children:o.agari==="tsumo"?"Under the Sea":"Under the River"}),(!s.disabledYaku.includes("\u5929\u548C")||!s.disabledYaku.includes("\u5730\u548C"))&&a(H,{toggled:o.blessing,disabled:o.agari==="ron"&&(s.enabledLocalYaku.includes("\u4EBA\u548C")?o.seatWind==="1":!0)||o.melds.length>0||o.nukidora>0,incompatible:o.riichi!=null||o.kan||o.lastTile,onToggle:u=>{p(null),m(h=>{h.blessing=u,u&&(h.riichi=null,h.uradora=[],h.lastTile=!1,h.kan=!1)})},children:o.seatWind==="1"?"Blessing of Heaven":s.enabledLocalYaku.includes("\u4EBA\u548C")&&o.agari==="ron"?"Blessing of Man":"Blessing of Earth"})]}),s.otherScoring&&t(O,{children:[t(J,{canDecrement:o.extraYakuHan>0,onDecrement:()=>{p(null),m(u=>{u.extraYakuHan--})},onIncrement:()=>{p(null),m(u=>{u.extraYakuHan++})},children:["Yaku (",o.extraYakuHan,")"]}),t(J,{canDecrement:o.extraDoraHan>0,onDecrement:()=>{p(null),m(u=>{u.extraDoraHan--})},onIncrement:()=>{p(null),m(u=>{u.extraDoraHan++})},children:["Dora (",o.extraDoraHan,")"]}),t(J,{canDecrement:o.extraYakuman>0,onDecrement:()=>{p(null),m(u=>{u.extraYakuman--})},onIncrement:()=>{p(null),m(u=>{u.extraYakuman++})},children:["Yakuman (",o.extraYakuman,")"]})]})]}),a("div",{ref:z,className:"w-full min-h-screen flex flex-col justify-center px-4 py-4 lg:py-8 bg-slate-300 dark:bg-sky-900",children:a(dn,{tileCount:N,result:S,transferButton:(e==null?void 0:e.t)==="transfer",onTransferClick:()=>{(S==null?void 0:S.agari)!=null&&Fe(S)}})}),a("div",{ref:R,className:"w-full min-h-screen flex flex-col justify-center px-4 py-4 lg:py-8",children:t("div",{className:"flex flex-col justify-center items-center gap-y-2 lg:gap-y-4",children:[a("h1",{className:"text-2xl lg:text-4xl",children:"Points Calculator"}),a(Xr,{han:P,fu:L,onHanChange:y,onFuChange:da}),a(ia,{result:{...Be,noYaku:!1,isOya:o.seatWind==="1",yakuman:0,yaku:[],han:P,fu:L,name:null},pao:(e==null?void 0:e.t)==="transfer"&&e.pao!=null}),(e==null?void 0:e.t)==="transfer"&&a("div",{className:"flex flex-col container lg:w-[50%]",children:a("button",{className:D("border border-gray-800 rounded-xl shadow py-1 lg:p-2 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600","h-24 text-2xl","bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800"),onClick:()=>{Fe(Be)},children:"Quick Transfer"})})]})})]})]})})}function ne({t:e,currentAction:r,onActionChange:i,disabled:n,children:l}){return a(v,{onClick:()=>i((r==null?void 0:r.t)===e?null:wn(e)),active:(r==null?void 0:r.t)===e,disabled:n,children:l})}function Cn({gameId:e,game:r,onClose:i}){const n=U(),{bottomWind:l,roundWind:s,round:c,repeats:x,riichiSticks:f,riichi:k,settings:o}=r,m=o.sanma!=null,d=m?4:3;return a(Q,{title:"Other Actions",onClose:i,children:a("div",{className:"flex flex-col justify-center items-center gap-y-2",children:t("div",{className:"flex flex-col justify-center items-center gap-y-2",children:[a(v,{onClick:()=>{(async()=>await n.setGame(e,{...r,bottomWind:A(l,-1,m)}))()},children:"Rotate Seats"}),t(J,{onDecrement:()=>{(async()=>await n.setGame(e,{...r,roundWind:c===1?A(s,-1,m):s,round:c===1?d:c-1}))()},onIncrement:()=>{(async()=>await n.setGame(e,{...r,roundWind:c===d?A(s,1,m):s,round:c===d?1:c+1}))()},children:[na(s)," ",c]}),t(J,{canDecrement:x>0,onDecrement:()=>{(async()=>await n.setGame(e,{...r,repeats:x-1}))()},onIncrement:()=>{(async()=>await n.setGame(e,{...r,repeats:x+1}))()},children:["Repeats (",x,")"]}),t(J,{canDecrement:f>k.filter(p=>p).length,onDecrement:()=>{(async()=>await n.setGame(e,{...r,riichiSticks:f-1}))()},onIncrement:()=>{(async()=>await n.setGame(e,{...r,riichiSticks:f+1}))()},children:["Riichi (",f,")"]})]})})})}function Dn({gameId:e,game:r,onClose:i}){const n=U(),{bottomWind:l,roundWind:s,round:c,repeats:x,settings:f}=r,k=f.sanma!=null,o=k?3:4,m=k?[0,1,2]:[0,1,2,3],[d,p]=w.exports.useState("exhaustive"),[Y,N]=we(new Set(r.riichi.flatMap((E,z)=>E?[z]:[]))),[F,T]=w.exports.useState(m.some(E=>Y.has(E)&&A(l,E,k)==="1")),$=async()=>{if(d==="abortive")await n.setGame(e,{...r,repeats:r.repeats+1,riichi:te(!1,k?3:4)});else{const E=r.scores.slice(),z=(k?[0,2e3,1e3,0]:[0,3e3,1500,1e3,0])[Y.size],V=(k?[0,1e3,2e3,0]:[0,1e3,1500,3e3,0])[Y.size];for(const S of k?[0,1,2]:[0,1,2,3])Y.has(S)?E[S]+=z:E[S]-=V;const R=F&&m.some(S=>Y.has(S)&&A(l,S,k)==="1");await n.setGame(e,{...r,bottomWind:R?l:A(l,-1,k),roundWind:R?s:c===o?A(s,1,k):s,round:R?c:c===o?1:c+1,repeats:x+1,scores:E,riichi:te(!1,k?3:4)})}i()};return a(Q,{onClose:i,title:"Handle Draws",children:t("div",{className:"flex flex-col justify-center items-center gap-y-8",children:[t("form",{className:"flex flex-col justify-center items-center gap-y-2",onSubmit:E=>{E.preventDefault(),$()},children:[a("p",{className:"text-xl lg:text-2xl",children:"Draw Type"}),a(Se,{left:"Exhaustive",right:"Abortive",toggled:d==="abortive",onToggle:E=>p(E?"abortive":"exhaustive")}),d==="exhaustive"&&t(_,{children:[a("p",{className:"text-xl lg:text-2xl",children:"Ready Players"}),a(O,{children:m.map(E=>a(W,{tile:`${A(l,E,k)}z`,dora:Y.has(E),forced:r.riichi[E],onClick:()=>{A(l,E,k)==="1"&&T(!Y.has(E)),N(z=>{z.has(E)?z.delete(E):z.add(E)})}},E))}),a(H,{toggled:F,onToggle:E=>T(E),children:"Repeat Round"})]})]}),a(v,{onClick:()=>{$()},children:"Submit"})]})})}function En({score:e,seatWind:r,vertical:i=!1,riichi:n=!1,onScoreClick:l,onTileClick:s,onRiichiClick:c}){return t("div",{className:D(i?"flex h-full w-[7.5rem] lg:w-40 flex-row-reverse":"flex flex-col w-full h-[7.5rem] lg:h-40","justify-center items-center gap-1"),children:[a("button",{onClick:c,className:D("text-center border border-gray-800 rounded-xl shadow text-sm md:text-lg lg:text-2xl",i?"[writing-mode:vertical-lr] py-8 px-1 h-40 lg:h-80":"px-8 py-1 w-40 lg:w-80",n?"bg-amber-500 enabled:hover:bg-amber-600 dark:bg-amber-700 dark:enabled:hover:bg-amber-800":"bg-gray-50 enabled:hover:bg-gray-200 dark:bg-gray-500 dark:enabled:hover:bg-gray-600"),children:"Riichi"}),t("div",{className:D(i?"flex flex-col h-full w-fit py-2 px-2 lg:px-4":"flex flex-row w-full h-fit px-2 py-2 lg:py-4","justify-center items-center bg-slate-300 dark:bg-sky-900 rounded-xl shadow"),children:[a("button",{className:D("text-4xl lg:text-6xl text-amber-700 dark:text-amber-500 font-bold",i?"[writing-mode:vertical-lr] h-48":"w-52"),onClick:l,children:e}),a("div",{className:D(i?"rotate-90 mx-2 -my-2 mt-auto":"ml-auto","flex flex-col justify-center items-center"),children:a(W,{onClick:s,red:r==="1",tile:`${r}z`})})]})]})}function Sn({toggled:e,left:r,middle:i,right:n,forced:l=!1,onToggle:s}){return a("div",{className:"flex flex-row w-52 lg:w-80 h-10 lg:h-14 text-xl lg:text-2xl",children:l?a("button",{disabled:!0,className:D("flex justify-center items-center rounded-xl border w-full shadow p-1 lg:p-2 border-gray-800","bg-amber-500 dark:bg-amber-700"),children:[r,i,n][e]}):t(_,{children:[a("button",{className:D("flex justify-center items-center rounded-xl w-1/3 border rounded-r-none shadow p-1 lg:p-2 border-gray-800 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600",e===0?"bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800":"bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600"),onClick:s?c=>{c.preventDefault(),e!==0&&s(0)}:void 0,children:r}),a("button",{className:D("flex justify-center items-center w-1/3 border shadow p-1 lg:p-2 border-gray-800 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600",e===1?"bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800":"bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600"),onClick:s?c=>{c.preventDefault(),e!==1&&s(1)}:void 0,children:i}),a("button",{className:D("flex justify-center items-center border rounded-l-none w-1/3 rounded-xl shadow p-1 lg:p-2 border-gray-800 disabled:bg-gray-300 dark:disabled:bg-gray-800 dark:disabled:text-gray-600",e===2?"bg-amber-500 hover:bg-amber-600 dark:bg-amber-700 dark:hover:bg-amber-800":"bg-gray-50 hover:bg-gray-200 dark:bg-gray-500 dark:hover:bg-gray-600"),onClick:s?c=>{c.preventDefault(),e!==2&&s(2)}:void 0,children:n})]})})}function Yn(){return a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 20l4-16m2 16l4-16M6 9h14M4 15h14"})})}function Bn({scoreUpdater:e,gameId:r,game:i,onClose:n}){const l=U(),{bottomWind:s,scores:c,settings:x}=i,f=x.sanma!=null,[k,o]=w.exports.useState(0),[m,d]=w.exports.useState(0),p=w.exports.useRef(null),Y=async()=>{const N=c.slice();switch(k){case 0:N[e]-=m;break;case 1:N[e]=m;break;case 2:N[e]+=m;break}await l.setGame(r,{...i,scores:N}),n()};return a(Q,{initialFocus:p,onClose:n,title:"Edit Score",children:t("div",{className:"flex flex-col gap-y-2 items-center justify-center",children:[a(W,{forced:!0,red:A(s,e,f)==="1",tile:`${A(s,e,f)}z`}),t("div",{className:"flex flex-col justify-center items-center gap-y-2",children:[a(Sn,{left:a("div",{className:"w-4 h-4 lg:w-6 lg:h-6",children:a(Je,{})}),middle:a("div",{className:"w-4 h-4 lg:w-6 lg:h-6",children:a(Yn,{})}),right:a("div",{className:"w-4 h-4 lg:w-6 lg:h-6",children:a(ea,{})}),toggled:k,onToggle:N=>o(N)}),a("form",{onSubmit:N=>{N.preventDefault(),Y()},children:a("input",{ref:p,type:"text",inputMode:"numeric",className:"bg-slate-300 dark:bg-sky-900 text-amber-700 dark:text-amber-500 font-bold text-center text-2xl lg:text-4xl rounded-xl w-52 lg:w-80 h-10 lg:h-14 p-1",value:m,onChange:N=>{var T,$;const F=Number(($=(T=N.target.value.match(/^\d+/))==null?void 0:T[0])!=null?$:0);isNaN(F)||d(F)}})}),a(v,{onClick:()=>{Y()},children:"Submit"})]})]})})}function Fn({winner:e,gameId:r,game:i,onClose:n}){const l=se(),{bottomWind:s,roundWind:c,settings:x}=i,f=x.sanma!=null,k=A(s,e,f),[o,m]=w.exports.useState({t:"tsumo"}),[d,p]=w.exports.useState(k!=="1"),[Y,N]=w.exports.useState(k==="1"),[F,T]=w.exports.useState(!0),[$,E]=w.exports.useState(!0),[z,V]=w.exports.useState(!1),[R,S]=w.exports.useState(null),P=()=>{const y={t:"transfer",id:r,roundWind:c,seatWind:k,winner:e,handleRotation:d,dealerRepeat:Y,scoreRiichiSticks:F,scoreRepeatSticks:$,pao:z?R:null,...o.t==="tsumo"?{agari:"tsumo"}:{agari:"ron",dealtInPlayer:o.dealIn}};l("/calculator",{state:y,replace:!0})};return a(Q,{onClose:n,title:"Transfer Points",children:t("div",{className:"flex flex-col justify-center items-center gap-y-8",children:[t("form",{className:"flex flex-col justify-center items-center gap-y-2",onSubmit:y=>{y.preventDefault(),P()},children:[a("p",{className:"text-xl lg:text-2xl",children:"Point Distribution"}),a(Se,{toggled:o.t==="ron",onToggle:y=>{m(y?{t:"ron",dealIn:(f?[0,1,2]:[0,1,2,3]).filter(L=>L!==e)[0]}:{t:"tsumo"})},left:"Tsumo",right:"Ron"}),o.t==="ron"&&t(_,{children:[a("p",{className:"text-xl lg:text-2xl",children:"Dealt-In Player"}),a(O,{children:(f?[0,1,2]:[0,1,2,3]).filter(y=>y!==e).map(y=>a(W,{tile:`${A(s,y,f)}z`,dora:y===o.dealIn,onClick:()=>{m({t:"ron",dealIn:y}),R===y&&S((f?[0,1,2]:[0,1,2,3]).filter(L=>L!==e&&L!==y)[0])}},y))})]}),a(H,{toggled:F,onToggle:y=>T(y),children:"Score Riichi Sticks"}),k!=="1"&&a(H,{toggled:$,onToggle:y=>E(y),children:"Score Repeat Sticks"}),x.usePao&&t(_,{children:[a(H,{toggled:z,onToggle:y=>{V(y),S(y?(f?[0,1,2]:[0,1,2,3]).filter(L=>L!==e&&(o.t==="ron"?L!==o.dealIn:!0))[0]:null)},children:"Pao"}),z&&t(_,{children:[a("p",{className:"text-xl lg:text-2xl",children:"Responsible Player"}),a(O,{children:(f?[0,1,2]:[0,1,2,3]).filter(y=>y!==e&&(o.t==="ron"?y!==o.dealIn:!0)).map(y=>a(W,{tile:`${A(s,y,f)}z`,dora:y===R,onClick:()=>S(y)},y))})]})]}),a("p",{className:"text-xl lg:text-2xl",children:"Seat Rotation"}),k==="1"&&a(H,{toggled:Y,incompatible:d,onToggle:y=>{N(y),y&&p(!1)},children:"Dealer Repeat"}),a(H,{toggled:d,incompatible:k==="1"&&Y,onToggle:y=>{p(y),y&&k==="1"&&N(!1)},children:"Rotate Seats"})]}),a(v,{onClick:()=>{P()},children:"Calculate Hand"})]})})}function An(){return a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 10l7-7m0 0l7 7m-7-7v18"})})}function Wn(){var s;const e=U(),i=(s=Ve().state)!=null?s:null,n=(i==null?void 0:i.t)==="load"?i.id:"$tools",l=e.useGame(n);return a("div",{className:"h-screen w-screen bg-slate-200 dark:bg-gray-900 text-black dark:text-white",children:l==null?a("div",{className:"w-screen h-screen flex flex-col justify-center items-center",children:a("div",{className:"fill-black dark:fill-white w-24 h-24",children:a(De,{})})}):l.ok?a(jn,{gameId:n,game:l.value}):a("div",{className:"w-screen h-screen flex flex-col justify-center items-center",children:t("div",{className:"text-red-600 dark:text-red-700 font-mono",children:["Error: Game ",n," does not exist."]})})})}function jn({gameId:e,game:r}){const i=U(),n=se(),[l,s]=w.exports.useState({width:window.innerWidth,height:window.innerHeight});w.exports.useEffect(()=>{const S=()=>{s({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)});const c=l.width<l.height,{roundWind:x,round:f,repeats:k,scores:o,riichi:m,riichiSticks:d,settings:p}=r,[Y,N]=w.exports.useState(null),[F,T]=w.exports.useState(null),[$,E]=w.exports.useState(!1),[z,V]=w.exports.useState(!1),R=async S=>{if(m[S]){const P=o.slice();P[S]=o[S]+1e3;const y=m.slice();y[S]=!1,await i.setGame(e,{...r,scores:P,riichiSticks:d-1,riichi:y})}else{const P=o.slice();P[S]=o[S]-1e3;const y=m.slice();y[S]=!0,await i.setGame(e,{...r,scores:P,riichiSticks:d+1,riichi:y})}};return t("div",{className:"relative h-screen w-screen",children:[a("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2",children:a("div",{className:"h-fit w-[min(70vh,70vw)]",children:a(me,{ix:0,game:r,onScoreClick:()=>N(0),onTileClick:()=>T(0),onRiichiClick:()=>void R(0)})})}),a("div",{className:"absolute right-0 top-1/2 -translate-y-1/2",children:a("div",{className:"rotate-180 h-[min(70vh,70vw)] w-fit",children:a(me,{vertical:!0,ix:1,game:r,onScoreClick:()=>N(1),onTileClick:()=>T(1),onRiichiClick:()=>void R(1)})})}),a("div",{className:"absolute top-0 left-1/2 -translate-x-1/2",children:a("div",{className:"rotate-180 h-fit w-[min(70vh,70vw)]",children:a(me,{ix:2,game:r,onScoreClick:()=>N(2),onTileClick:()=>T(2),onRiichiClick:()=>void R(2)})})}),p.sanma==null&&a("div",{className:"absolute left-0 top-1/2 -translate-y-1/2",children:a("div",{className:"h-[min(70vh,70vw)] w-fit",children:a(me,{vertical:!0,ix:3,game:r,onScoreClick:()=>N(3),onTileClick:()=>T(3),onRiichiClick:()=>void R(3)})})}),Y!=null&&a(Bn,{gameId:e,game:r,scoreUpdater:Y,onClose:()=>N(null)}),F!=null&&a(Fn,{gameId:e,game:r,winner:F,onClose:()=>T(null)}),$&&a(Dn,{gameId:e,game:r,onClose:()=>E(!1)}),z&&a(Cn,{gameId:e,game:r,onClose:()=>V(!1)}),a("div",{"data-1c1":!0,className:D("absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-slate-300 dark:bg-sky-900 rounded-xl shadow",c?"[writing-mode:vertical-lr] p-2 h-[min(70vh,70vw)]":"p-2 w-[min(70vh,70vw)]"),children:t("div",{className:"flex flex-row justify-between items-center gap-x-4",children:[a("div",{className:D(c?"rotate-90 mx-2 -my-2":"flex flex-col justify-center items-center"),children:a(W,{onClick:()=>{E(!0)},tile:`${x}z`})}),t("div",{className:D(c?"flex flex-col-reverse":"flex flex-col","gap-y-2 justify-between items-center text-xl lg:text-4xl"),children:[t("span",{children:[na(x)," ",f]}),t("div",{className:"flex flex-row gap-x-4 justify-center items-center",children:[t("span",{className:"flex flex-row gap-x-2 justify-center items-center",children:[a("span",{className:D("text-slate-900 dark:text-slate-400 rotate-90",c?"mr-0.5 lg:mr-2":"mt-2 lg:mt-2"),children:"\u283F"})," ",k]}),t("span",{className:"flex flex-row gap-x-2 justify-center items-center",children:[a("span",{className:D("text-red-500 dark:text-red-600",c?"mr-0.5 lg:mr-2":""),children:"\u25CF"})," ",d]})]})]}),t("div",{className:D(c?"flex flex-col-reverse":"flex flex-col","gap-y-2"),children:[a(ae,{onClick:()=>{n("/",{replace:!0})},children:c?a(An,{}):a(ta,{})}),a(ae,{onClick:()=>{V(!0)},children:a(la,{})})]})]})})]})}function me({game:e,ix:r,vertical:i=!1,onScoreClick:n,onTileClick:l,onRiichiClick:s}){const{bottomWind:c,scores:x,riichi:f,settings:k}=e;return a(En,{vertical:i,score:x[r],riichi:f[r],seatWind:A(c,r,k.sanma!=null),onScoreClick:n,onTileClick:l,onRiichiClick:s})}const Tn="/riichi-tracker/assets/github-corner-right.04e2fb8e.svg";function zn({onClose:e}){const r=se(),i=U(),[n,l]=w.exports.useState(!1),[s,c]=w.exports.useState(25e3),[x,f]=w.exports.useState("1"),[k,o]=w.exports.useState(Ee),m=w.exports.useRef(null),d=async()=>{await i.setGame("$tools",{bottomWind:x,roundWind:"1",round:1,repeats:0,scores:te(s,k.sanma?3:4),riichiSticks:0,riichi:te(!1,k.sanma?3:4),settings:k}),r("/compass",{state:{t:"load",id:"$tools"},replace:!0})};return a(Q,{initialFocus:m,onClose:e,title:"New Game",children:t("div",{className:"flex flex-col justify-center items-center gap-y-8",children:[t("form",{className:"flex flex-col justify-center items-center gap-y-2",onSubmit:p=>{p.preventDefault(),d()},children:[a("p",{className:"text-xl lg:text-2xl",children:"Initial Score"}),a("input",{ref:m,type:"text",inputMode:"numeric",className:"bg-slate-300 dark:bg-sky-900 text-amber-700 dark:text-amber-500 font-bold text-center text-2xl lg:text-4xl rounded-xl w-52 lg:w-80 h-10 lg:h-14 p-1",value:s,onChange:p=>{var N,F;const Y=Number((F=(N=p.target.value.match(/^\d+/))==null?void 0:N[0])!=null?F:0);isNaN(Y)||c(Y)}},"scoreInput"),a("p",{className:"text-xl lg:text-2xl",children:"Your Seat Wind"}),a("div",{children:a(Ce,{value:x,redEast:!0,sanma:k.sanma!=null,onChange:p=>f(p)})}),a(H,{toggled:n,onToggle:()=>l(!0),children:"Settings"}),n&&a(ua,{allowCopy:!0,inCalculator:!1,settings:k,onSettingsChange:p=>{o(p),p.sanma==null?c(25e3):c(35e3)},onClose:()=>{l(!1)}})]}),a(v,{onClick:()=>{d()},children:"Create Compass"})]})})}function Rn(){return a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})}function Mn(){return a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}function Hn(){return a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})}function $n(){const e=se(),r=U(),i=r.useGame("$tools"),[n,l]=aa("theme"),[s,c]=w.exports.useState(!1);return t("div",{className:"min-h-screen bg-slate-200 dark:bg-gray-900 text-black dark:text-white",children:[a("div",{className:"fixed top-0 right-0",children:a("a",{href:"https://github.com/1Computer1/riichi-tracker",children:a("img",{src:Tn})})}),a("div",{className:"fixed top-2 left-2 lg:top-4 lg:left-4 flex flex-col gap-y-2",children:a(ae,{onClick:()=>{ka.exports.flushSync(()=>{l(n==="dark"?null:n==="light"?"dark":"light")}),Ze()},children:n==="dark"?a(Mn,{}):n==="light"?a(Hn,{}):a(Rn,{})})}),t("div",{className:"flex flex-col justify-center items-center min-h-screen gap-y-4 lg:gap-y-8 py-4 px-2",children:[a("h1",{className:"text-4xl lg:text-6xl text-center",children:"Riichi Tracker"}),a("h2",{className:"text-xl lg:text-2xl text-center",children:"Keep track of your games!"}),a("div",{className:"flex flex-row justify-center items-start gap-x-8",children:a("div",{className:"flex flex-col justify-center items-center gap-y-2 lg:gap-y-4",children:t("div",{className:"flex flex-col justify-center items-center gap-y-2 lg:gap-y-4",children:[a(v,{onClick:()=>c(!0),children:"New Game"}),a(v,{disabled:i==null||!i.ok,onClick:()=>{e("/compass",{state:{t:"load",id:"$tools"},replace:!0})},children:"Continue"}),a(v,{onClick:()=>{(async()=>((await r.getSettings("$global")).ok||await r.setSettings("$global",Ee),e("/calculator",{state:{t:"load",id:"$global"},replace:!0})))()},children:"Calculator"})]})})}),t("ul",{className:"text-base lg:text-xl flex flex-col justify-center items-start gap-y-1 lg:gap-y-2 list-disc px-6",children:[t("li",{children:["Create a ",a("span",{className:"text-amber-700 dark:text-amber-500",children:"Compass"})," by using the"," ",a("span",{className:"text-amber-700 dark:text-amber-500",children:"New Game"})," button."]}),t("li",{children:["Add riichi sticks by tapping on the ",a("span",{className:"text-amber-700 dark:text-amber-500",children:"Riichi"})," ","button."]}),t("li",{children:["Transfer scores by tapping on the"," ",a("span",{className:"text-amber-700 dark:text-amber-500",children:"winning player's wind tile"})," and using the"," ",a("span",{className:"text-amber-700 dark:text-amber-500",children:"Calculator"}),"."]}),t("li",{children:["Handle draws and repeats by tapping on the"," ",a("span",{className:"text-amber-700 dark:text-amber-500",children:"center wind tile"}),"."]}),t("li",{children:["Manually edit scores by tapping on a"," ",a("span",{className:"text-amber-700 dark:text-amber-500",children:"player's score display"}),"."]}),t("li",{children:["Manually edit seats, rounds, and sticks by tapping on the"," ",a("span",{className:"text-amber-700 dark:text-amber-500",children:"gear button"}),"."]}),a("li",{children:"Place your phone at the center of the table and enjoy!"}),t("li",{children:["You can also use the ",a("span",{className:"text-amber-700 dark:text-amber-500",children:"Calculator"})," by itself outside of a game."]})]})]}),s&&a(zn,{onClose:()=>c(!1)})]})}function Pn(e={}){const{immediate:r=!1,onNeedRefresh:i,onOfflineReady:n,onRegistered:l,onRegisterError:s}=e;let c;const x=async(f=!0)=>{};return"serviceWorker"in navigator&&(c=new va("/riichi-tracker/sw.js",{scope:"/riichi-tracker/",type:"classic"}),c.addEventListener("activated",f=>{f.isUpdate?window.location.reload():n==null||n()}),c.register({immediate:r}).then(f=>{l==null||l(f)}).catch(f=>{s==null||s(f)})),x}Ze();Pn({onRegistered(e){e&&e.update()}});ya();wa.createRoot(document.getElementById("root")).render(a(Na.StrictMode,{children:a(kn,{repository:Vr,children:a(Ca,{children:t(Da,{children:[a(be,{path:"/",element:a($n,{})}),a(be,{path:"/calculator",element:a(Nn,{})}),a(be,{path:"/compass",element:a(Wn,{})})]})})})}));
